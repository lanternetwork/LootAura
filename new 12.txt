Run npm run test
  npm run test
  shell: /usr/bin/bash -e {0}
  env:
    NEXT_PUBLIC_SUPABASE_URL: ***
    NEXT_PUBLIC_SUPABASE_ANON_KEY: ***
    NEXT_PUBLIC_SUPABASE_SCHEMA: public
    NEXT_PUBLIC_DEBUG: true

> yard-sale-finder@0.1.0 test
> NODE_OPTIONS='--max-old-space-size=8192 --expose-gc' vitest run

The CJS build of Vite's Node API is deprecated. See https://vite.dev/guide/troubleshooting.html#vite-cjs-node-api-deprecated for more details.

 RUN  v2.1.9 /home/runner/work/LootAura/LootAura

 ✓ tests/integration/categoryFilters.test.ts (22 tests) 21ms
 ✓ tests/unit/categoryNormalizer.test.ts (34 tests) 16ms
stdout | tests/components/AddSaleForm.a11y.test.tsx > AddSaleForm Accessibility > should support form submission with Enter key
[usage] geocode call (count=1)

 ✓ tests/integration/category-filters.test.ts (16 tests) 11ms
 ✓ tests/unit/server-stabilization.test.ts (14 tests) 8ms
 ❯ tests/components/AddSaleForm.a11y.test.tsx (11 tests | 11 failed) 697ms
   × AddSaleForm Accessibility > should have proper form labels and structure 116ms
     → Invalid Chai property: toBeInTheDocument
   × AddSaleForm Accessibility > should have proper input types and attributes 23ms
     → Invalid Chai property: toHaveAttribute
   × AddSaleForm Accessibility > should have proper button roles and labels 51ms
     → Invalid Chai property: toBeInTheDocument
   × AddSaleForm Accessibility > should support keyboard navigation 79ms
     → Invalid Chai property: toHaveFocus
   × AddSaleForm Accessibility > should support form submission with Enter key 252ms
     → Invalid Chai property: toBeInTheDocument
   × AddSaleForm Accessibility > should support adding tags with Enter key 108ms
     → Invalid Chai property: toBeInTheDocument
   × AddSaleForm Accessibility > should have proper error handling and announcements 11ms
     → Invalid Chai property: toBeInTheDocument
   × AddSaleForm Accessibility > should have proper fieldset and legend structure for grouped fields 14ms
     → Invalid Chai property: toBeInTheDocument
   × AddSaleForm Accessibility > should have proper focus management 20ms
     → Invalid Chai property: toHaveFocus
   × AddSaleForm Accessibility > should have proper ARIA attributes 14ms
     → Invalid Chai property: toBeInTheDocument
   × AddSaleForm Accessibility > should support screen reader navigation 8ms
     → Invalid Chai property: toBeInTheDocument
 ✓ tests/unit/stabilization.test.ts (21 tests) 12ms
 ✓ tests/unit/categoryNormalization.test.ts (16 tests) 10ms
 ✓ tests/unit/arbiterDecisions.test.ts (14 tests) 11ms
 ✓ tests/integration/stabilization.spec.ts (16 tests) 15ms
 ❯ tests/integration/rls.owner.test.ts (6 tests | 6 failed) 98ms
   × RLS and Owner Permissions > should set owner_id to auth.uid() when inserting sale 90ms
     → vi.mocked(...).mockResolvedValue is not a function
   × RLS and Owner Permissions > should allow public read access to sales list 2ms
     → vi.mocked(...).mockResolvedValue is not a function
   × RLS and Owner Permissions > should allow owner to update their own sale 1ms
     → vi.mocked(...).mockResolvedValue is not a function
   × RLS and Owner Permissions > should prevent non-owner from updating sale 1ms
     → vi.mocked(...).mockResolvedValue is not a function
   × RLS and Owner Permissions > should allow owner to delete their own sale 1ms
     → vi.mocked(...).mockResolvedValue is not a function
   × RLS and Owner Permissions > should prevent non-owner from deleting sale 1ms
     → supabase.auth.getUser.mockResolvedValue is not a function
stderr | tests/components/SalesGrid.test.tsx > SalesGrid > renders sales cards when not loading and sales are present
Error: Uncaught [ReferenceError: ResizeObserver is not defined]
    at reportException (/home/runner/work/LootAura/LootAura/node_modules/jsdom/lib/jsdom/living/helpers/runtime-script-errors.js:66:24)
    at innerInvokeEventListeners (/home/runner/work/LootAura/LootAura/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:353:9)
    at invokeEventListeners (/home/runner/work/LootAura/LootAura/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:286:3)
    at HTMLUnknownElementImpl._dispatch (/home/runner/work/LootAura/LootAura/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:233:9)
    at HTMLUnknownElementImpl.dispatchEvent (/home/runner/work/LootAura/LootAura/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:104:17)
    at HTMLUnknownElement.dispatchEvent (/home/runner/work/LootAura/LootAura/node_modules/jsdom/lib/jsdom/living/generated/EventTarget.js:241:34)
    at Object.invokeGuardedCallbackDev (/home/runner/work/LootAura/LootAura/node_modules/react-dom/cjs/react-dom.development.js:4213:16)
    at invokeGuardedCallback (/home/runner/work/LootAura/LootAura/node_modules/react-dom/cjs/react-dom.development.js:4277:31)
    at reportUncaughtErrorInDEV (/home/runner/work/LootAura/LootAura/node_modules/react-dom/cjs/react-dom.development.js:22877:5)
    at captureCommitPhaseError (/home/runner/work/LootAura/LootAura/node_modules/react-dom/cjs/react-dom.development.js:27165:5) ReferenceError: ResizeObserver is not defined
    at /home/runner/work/LootAura/LootAura/components/SalesGrid.tsx:51:28
    at commitHookEffectListMount (/home/runner/work/LootAura/LootAura/node_modules/react-dom/cjs/react-dom.development.js:23189:26)
    at commitPassiveMountOnFiber (/home/runner/work/LootAura/LootAura/node_modules/react-dom/cjs/react-dom.development.js:24970:11)
    at commitPassiveMountEffects_complete (/home/runner/work/LootAura/LootAura/node_modules/react-dom/cjs/react-dom.development.js:24930:9)
    at commitPassiveMountEffects_begin (/home/runner/work/LootAura/LootAura/node_modules/react-dom/cjs/react-dom.development.js:24917:7)
    at commitPassiveMountEffects (/home/runner/work/LootAura/LootAura/node_modules/react-dom/cjs/react-dom.development.js:24905:3)
    at flushPassiveEffectsImpl (/home/runner/work/LootAura/LootAura/node_modules/react-dom/cjs/react-dom.development.js:27078:3)
    at flushPassiveEffects (/home/runner/work/LootAura/LootAura/node_modules/react-dom/cjs/react-dom.development.js:27023:14)
    at /home/runner/work/LootAura/LootAura/node_modules/react-dom/cjs/react-dom.development.js:26808:9
    at flushActQueue (/home/runner/work/LootAura/LootAura/node_modules/react/cjs/react.development.js:2667:24)
The above error occurred in the <SalesGrid> component:

    at SalesGrid (/home/runner/work/LootAura/LootAura/components/SalesGrid.tsx:11:3)
    at QueryClientProvider (file:///home/runner/work/LootAura/LootAura/node_modules/@tanstack/react-query/build/modern/QueryClientProvider.js:20:3)
    at wrapper (/home/runner/work/LootAura/LootAura/tests/utils/renderWithProviders.tsx:11:22)

Consider adding an error boundary to your tree to customize error handling behavior.
Visit https://reactjs.org/link/error-boundaries to learn more about error boundaries.

stderr | tests/components/SalesGrid.test.tsx > SalesGrid > renders skeletons when loading and not in MAP authority
Error: Uncaught [ReferenceError: ResizeObserver is not defined]
    at reportException (/home/runner/work/LootAura/LootAura/node_modules/jsdom/lib/jsdom/living/helpers/runtime-script-errors.js:66:24)
    at innerInvokeEventListeners (/home/runner/work/LootAura/LootAura/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:353:9)
    at invokeEventListeners (/home/runner/work/LootAura/LootAura/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:286:3)
    at HTMLUnknownElementImpl._dispatch (/home/runner/work/LootAura/LootAura/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:233:9)
    at HTMLUnknownElementImpl.dispatchEvent (/home/runner/work/LootAura/LootAura/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:104:17)
    at HTMLUnknownElement.dispatchEvent (/home/runner/work/LootAura/LootAura/node_modules/jsdom/lib/jsdom/living/generated/EventTarget.js:241:34)
    at Object.invokeGuardedCallbackDev (/home/runner/work/LootAura/LootAura/node_modules/react-dom/cjs/react-dom.development.js:4213:16)
    at invokeGuardedCallback (/home/runner/work/LootAura/LootAura/node_modules/react-dom/cjs/react-dom.development.js:4277:31)
    at reportUncaughtErrorInDEV (/home/runner/work/LootAura/LootAura/node_modules/react-dom/cjs/react-dom.development.js:22877:5)
    at captureCommitPhaseError (/home/runner/work/LootAura/LootAura/node_modules/react-dom/cjs/react-dom.development.js:27165:5) ReferenceError: ResizeObserver is not defined
    at /home/runner/work/LootAura/LootAura/components/SalesGrid.tsx:51:28
    at commitHookEffectListMount (/home/runner/work/LootAura/LootAura/node_modules/react-dom/cjs/react-dom.development.js:23189:26)
    at commitPassiveMountOnFiber (/home/runner/work/LootAura/LootAura/node_modules/react-dom/cjs/react-dom.development.js:24970:11)
    at commitPassiveMountEffects_complete (/home/runner/work/LootAura/LootAura/node_modules/react-dom/cjs/react-dom.development.js:24930:9)
    at commitPassiveMountEffects_begin (/home/runner/work/LootAura/LootAura/node_modules/react-dom/cjs/react-dom.development.js:24917:7)
    at commitPassiveMountEffects (/home/runner/work/LootAura/LootAura/node_modules/react-dom/cjs/react-dom.development.js:24905:3)
    at flushPassiveEffectsImpl (/home/runner/work/LootAura/LootAura/node_modules/react-dom/cjs/react-dom.development.js:27078:3)
    at flushPassiveEffects (/home/runner/work/LootAura/LootAura/node_modules/react-dom/cjs/react-dom.development.js:27023:14)
    at /home/runner/work/LootAura/LootAura/node_modules/react-dom/cjs/react-dom.development.js:26808:9
    at flushActQueue (/home/runner/work/LootAura/LootAura/node_modules/react/cjs/react.development.js:2667:24)
The above error occurred in the <SalesGrid> component:

    at SalesGrid (/home/runner/work/LootAura/LootAura/components/SalesGrid.tsx:11:3)
    at QueryClientProvider (file:///home/runner/work/LootAura/LootAura/node_modules/@tanstack/react-query/build/modern/QueryClientProvider.js:20:3)
    at wrapper (/home/runner/work/LootAura/LootAura/tests/utils/renderWithProviders.tsx:11:22)

Consider adding an error boundary to your tree to customize error handling behavior.
Visit https://reactjs.org/link/error-boundaries to learn more about error boundaries.

stderr | tests/components/SalesGrid.test.tsx > SalesGrid > renders empty state message when no sales and not loading
Error: Uncaught [ReferenceError: ResizeObserver is not defined]
    at reportException (/home/runner/work/LootAura/LootAura/node_modules/jsdom/lib/jsdom/living/helpers/runtime-script-errors.js:66:24)
    at innerInvokeEventListeners (/home/runner/work/LootAura/LootAura/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:353:9)
    at invokeEventListeners (/home/runner/work/LootAura/LootAura/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:286:3)
    at HTMLUnknownElementImpl._dispatch (/home/runner/work/LootAura/LootAura/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:233:9)
    at HTMLUnknownElementImpl.dispatchEvent (/home/runner/work/LootAura/LootAura/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:104:17)
    at HTMLUnknownElement.dispatchEvent (/home/runner/work/LootAura/LootAura/node_modules/jsdom/lib/jsdom/living/generated/EventTarget.js:241:34)
    at Object.invokeGuardedCallbackDev (/home/runner/work/LootAura/LootAura/node_modules/react-dom/cjs/react-dom.development.js:4213:16)
    at invokeGuardedCallback (/home/runner/work/LootAura/LootAura/node_modules/react-dom/cjs/react-dom.development.js:4277:31)
    at reportUncaughtErrorInDEV (/home/runner/work/LootAura/LootAura/node_modules/react-dom/cjs/react-dom.development.js:22877:5)
    at captureCommitPhaseError (/home/runner/work/LootAura/LootAura/node_modules/react-dom/cjs/react-dom.development.js:27165:5) ReferenceError: ResizeObserver is not defined
    at /home/runner/work/LootAura/LootAura/components/SalesGrid.tsx:51:28
    at commitHookEffectListMount (/home/runner/work/LootAura/LootAura/node_modules/react-dom/cjs/react-dom.development.js:23189:26)
    at commitPassiveMountOnFiber (/home/runner/work/LootAura/LootAura/node_modules/react-dom/cjs/react-dom.development.js:24970:11)
    at commitPassiveMountEffects_complete (/home/runner/work/LootAura/LootAura/node_modules/react-dom/cjs/react-dom.development.js:24930:9)
    at commitPassiveMountEffects_begin (/home/runner/work/LootAura/LootAura/node_modules/react-dom/cjs/react-dom.development.js:24917:7)
    at commitPassiveMountEffects (/home/runner/work/LootAura/LootAura/node_modules/react-dom/cjs/react-dom.development.js:24905:3)
    at flushPassiveEffectsImpl (/home/runner/work/LootAura/LootAura/node_modules/react-dom/cjs/react-dom.development.js:27078:3)
    at flushPassiveEffects (/home/runner/work/LootAura/LootAura/node_modules/react-dom/cjs/react-dom.development.js:27023:14)
    at /home/runner/work/LootAura/LootAura/node_modules/react-dom/cjs/react-dom.development.js:26808:9
    at flushActQueue (/home/runner/work/LootAura/LootAura/node_modules/react/cjs/react.development.js:2667:24)
The above error occurred in the <SalesGrid> component:

    at SalesGrid (/home/runner/work/LootAura/LootAura/components/SalesGrid.tsx:11:3)
    at QueryClientProvider (file:///home/runner/work/LootAura/LootAura/node_modules/@tanstack/react-query/build/modern/QueryClientProvider.js:20:3)
    at wrapper (/home/runner/work/LootAura/LootAura/tests/utils/renderWithProviders.tsx:11:22)

Consider adding an error boundary to your tree to customize error handling behavior.
Visit https://reactjs.org/link/error-boundaries to learn more about error boundaries.

stderr | tests/components/SalesGrid.test.tsx > SalesGrid > does not render skeletons when in MAP authority, even if loading
Error: Uncaught [ReferenceError: ResizeObserver is not defined]
    at reportException (/home/runner/work/LootAura/LootAura/node_modules/jsdom/lib/jsdom/living/helpers/runtime-script-errors.js:66:24)
    at innerInvokeEventListeners (/home/runner/work/LootAura/LootAura/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:353:9)
    at invokeEventListeners (/home/runner/work/LootAura/LootAura/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:286:3)
    at HTMLUnknownElementImpl._dispatch (/home/runner/work/LootAura/LootAura/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:233:9)
    at HTMLUnknownElementImpl.dispatchEvent (/home/runner/work/LootAura/LootAura/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:104:17)
    at HTMLUnknownElement.dispatchEvent (/home/runner/work/LootAura/LootAura/node_modules/jsdom/lib/jsdom/living/generated/EventTarget.js:241:34)
    at Object.invokeGuardedCallbackDev (/home/runner/work/LootAura/LootAura/node_modules/react-dom/cjs/react-dom.development.js:4213:16)
    at invokeGuardedCallback (/home/runner/work/LootAura/LootAura/node_modules/react-dom/cjs/react-dom.development.js:4277:31)
    at reportUncaughtErrorInDEV (/home/runner/work/LootAura/LootAura/node_modules/react-dom/cjs/react-dom.development.js:22877:5)
    at captureCommitPhaseError (/home/runner/work/LootAura/LootAura/node_modules/react-dom/cjs/react-dom.development.js:27165:5) ReferenceError: ResizeObserver is not defined
    at /home/runner/work/LootAura/LootAura/components/SalesGrid.tsx:51:28
    at commitHookEffectListMount (/home/runner/work/LootAura/LootAura/node_modules/react-dom/cjs/react-dom.development.js:23189:26)
    at commitPassiveMountOnFiber (/home/runner/work/LootAura/LootAura/node_modules/react-dom/cjs/react-dom.development.js:24970:11)
    at commitPassiveMountEffects_complete (/home/runner/work/LootAura/LootAura/node_modules/react-dom/cjs/react-dom.development.js:24930:9)
    at commitPassiveMountEffects_begin (/home/runner/work/LootAura/LootAura/node_modules/react-dom/cjs/react-dom.development.js:24917:7)
    at commitPassiveMountEffects (/home/runner/work/LootAura/LootAura/node_modules/react-dom/cjs/react-dom.development.js:24905:3)
    at flushPassiveEffectsImpl (/home/runner/work/LootAura/LootAura/node_modules/react-dom/cjs/react-dom.development.js:27078:3)
    at flushPassiveEffects (/home/runner/work/LootAura/LootAura/node_modules/react-dom/cjs/react-dom.development.js:27023:14)
    at /home/runner/work/LootAura/LootAura/node_modules/react-dom/cjs/react-dom.development.js:26808:9
    at flushActQueue (/home/runner/work/LootAura/LootAura/node_modules/react/cjs/react.development.js:2667:24)
The above error occurred in the <SalesGrid> component:

    at SalesGrid (/home/runner/work/LootAura/LootAura/components/SalesGrid.tsx:11:3)
    at QueryClientProvider (file:///home/runner/work/LootAura/LootAura/node_modules/@tanstack/react-query/build/modern/QueryClientProvider.js:20:3)
    at wrapper (/home/runner/work/LootAura/LootAura/tests/utils/renderWithProviders.tsx:11:22)

Consider adding an error boundary to your tree to customize error handling behavior.
Visit https://reactjs.org/link/error-boundaries to learn more about error boundaries.

stderr | tests/components/SalesGrid.test.tsx > SalesGrid > observes resize events and updates columns
Error: Uncaught [ReferenceError: ResizeObserver is not defined]
    at reportException (/home/runner/work/LootAura/LootAura/node_modules/jsdom/lib/jsdom/living/helpers/runtime-script-errors.js:66:24)
    at innerInvokeEventListeners (/home/runner/work/LootAura/LootAura/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:353:9)
    at invokeEventListeners (/home/runner/work/LootAura/LootAura/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:286:3)
    at HTMLUnknownElementImpl._dispatch (/home/runner/work/LootAura/LootAura/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:233:9)
    at HTMLUnknownElementImpl.dispatchEvent (/home/runner/work/LootAura/LootAura/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:104:17)
    at HTMLUnknownElement.dispatchEvent (/home/runner/work/LootAura/LootAura/node_modules/jsdom/lib/jsdom/living/generated/EventTarget.js:241:34)
    at Object.invokeGuardedCallbackDev (/home/runner/work/LootAura/LootAura/node_modules/react-dom/cjs/react-dom.development.js:4213:16)
    at invokeGuardedCallback (/home/runner/work/LootAura/LootAura/node_modules/react-dom/cjs/react-dom.development.js:4277:31)
    at reportUncaughtErrorInDEV (/home/runner/work/LootAura/LootAura/node_modules/react-dom/cjs/react-dom.development.js:22877:5)
    at captureCommitPhaseError (/home/runner/work/LootAura/LootAura/node_modules/react-dom/cjs/react-dom.development.js:27165:5) ReferenceError: ResizeObserver is not defined
    at /home/runner/work/LootAura/LootAura/components/SalesGrid.tsx:51:28
    at commitHookEffectListMount (/home/runner/work/LootAura/LootAura/node_modules/react-dom/cjs/react-dom.development.js:23189:26)
    at commitPassiveMountOnFiber (/home/runner/work/LootAura/LootAura/node_modules/react-dom/cjs/react-dom.development.js:24970:11)
    at commitPassiveMountEffects_complete (/home/runner/work/LootAura/LootAura/node_modules/react-dom/cjs/react-dom.development.js:24930:9)
    at commitPassiveMountEffects_begin (/home/runner/work/LootAura/LootAura/node_modules/react-dom/cjs/react-dom.development.js:24917:7)
    at commitPassiveMountEffects (/home/runner/work/LootAura/LootAura/node_modules/react-dom/cjs/react-dom.development.js:24905:3)
    at flushPassiveEffectsImpl (/home/runner/work/LootAura/LootAura/node_modules/react-dom/cjs/react-dom.development.js:27078:3)
    at flushPassiveEffects (/home/runner/work/LootAura/LootAura/node_modules/react-dom/cjs/react-dom.development.js:27023:14)
    at /home/runner/work/LootAura/LootAura/node_modules/react-dom/cjs/react-dom.development.js:26808:9
    at flushActQueue (/home/runner/work/LootAura/LootAura/node_modules/react/cjs/react.development.js:2667:24)
The above error occurred in the <SalesGrid> component:

    at SalesGrid (/home/runner/work/LootAura/LootAura/components/SalesGrid.tsx:11:3)
    at QueryClientProvider (file:///home/runner/work/LootAura/LootAura/node_modules/@tanstack/react-query/build/modern/QueryClientProvider.js:20:3)
    at wrapper (/home/runner/work/LootAura/LootAura/tests/utils/renderWithProviders.tsx:11:22)

Consider adding an error boundary to your tree to customize error handling behavior.
Visit https://reactjs.org/link/error-boundaries to learn more about error boundaries.

stderr | tests/components/SalesGrid.test.tsx > SalesGrid > cleans up ResizeObserver on unmount
Error: Uncaught [ReferenceError: ResizeObserver is not defined]
    at reportException (/home/runner/work/LootAura/LootAura/node_modules/jsdom/lib/jsdom/living/helpers/runtime-script-errors.js:66:24)
    at innerInvokeEventListeners (/home/runner/work/LootAura/LootAura/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:353:9)
    at invokeEventListeners (/home/runner/work/LootAura/LootAura/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:286:3)
    at HTMLUnknownElementImpl._dispatch (/home/runner/work/LootAura/LootAura/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:233:9)
    at HTMLUnknownElementImpl.dispatchEvent (/home/runner/work/LootAura/LootAura/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:104:17)
    at HTMLUnknownElement.dispatchEvent (/home/runner/work/LootAura/LootAura/node_modules/jsdom/lib/jsdom/living/generated/EventTarget.js:241:34)
    at Object.invokeGuardedCallbackDev (/home/runner/work/LootAura/LootAura/node_modules/react-dom/cjs/react-dom.development.js:4213:16)
    at invokeGuardedCallback (/home/runner/work/LootAura/LootAura/node_modules/react-dom/cjs/react-dom.development.js:4277:31)
    at reportUncaughtErrorInDEV (/home/runner/work/LootAura/LootAura/node_modules/react-dom/cjs/react-dom.development.js:22877:5)
    at captureCommitPhaseError (/home/runner/work/LootAura/LootAura/node_modules/react-dom/cjs/react-dom.development.js:27165:5) ReferenceError: ResizeObserver is not defined
    at /home/runner/work/LootAura/LootAura/components/SalesGrid.tsx:51:28
    at commitHookEffectListMount (/home/runner/work/LootAura/LootAura/node_modules/react-dom/cjs/react-dom.development.js:23189:26)
    at commitPassiveMountOnFiber (/home/runner/work/LootAura/LootAura/node_modules/react-dom/cjs/react-dom.development.js:24970:11)
    at commitPassiveMountEffects_complete (/home/runner/work/LootAura/LootAura/node_modules/react-dom/cjs/react-dom.development.js:24930:9)
    at commitPassiveMountEffects_begin (/home/runner/work/LootAura/LootAura/node_modules/react-dom/cjs/react-dom.development.js:24917:7)
    at commitPassiveMountEffects (/home/runner/work/LootAura/LootAura/node_modules/react-dom/cjs/react-dom.development.js:24905:3)
    at flushPassiveEffectsImpl (/home/runner/work/LootAura/LootAura/node_modules/react-dom/cjs/react-dom.development.js:27078:3)
    at flushPassiveEffects (/home/runner/work/LootAura/LootAura/node_modules/react-dom/cjs/react-dom.development.js:27023:14)
    at /home/runner/work/LootAura/LootAura/node_modules/react-dom/cjs/react-dom.development.js:26808:9
    at flushActQueue (/home/runner/work/LootAura/LootAura/node_modules/react/cjs/react.development.js:2667:24)
The above error occurred in the <SalesGrid> component:

    at SalesGrid (/home/runner/work/LootAura/LootAura/components/SalesGrid.tsx:11:3)
    at QueryClientProvider (file:///home/runner/work/LootAura/LootAura/node_modules/@tanstack/react-query/build/modern/QueryClientProvider.js:20:3)
    at wrapper (/home/runner/work/LootAura/LootAura/tests/utils/renderWithProviders.tsx:11:22)

Consider adding an error boundary to your tree to customize error handling behavior.
Visit https://reactjs.org/link/error-boundaries to learn more about error boundaries.

stderr | tests/components/SalesGrid.test.tsx > SalesGrid > applies custom className
Error: Uncaught [ReferenceError: ResizeObserver is not defined]
    at reportException (/home/runner/work/LootAura/LootAura/node_modules/jsdom/lib/jsdom/living/helpers/runtime-script-errors.js:66:24)
    at innerInvokeEventListeners (/home/runner/work/LootAura/LootAura/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:353:9)
    at invokeEventListeners (/home/runner/work/LootAura/LootAura/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:286:3)
    at HTMLUnknownElementImpl._dispatch (/home/runner/work/LootAura/LootAura/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:233:9)
    at HTMLUnknownElementImpl.dispatchEvent (/home/runner/work/LootAura/LootAura/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:104:17)
    at HTMLUnknownElement.dispatchEvent (/home/runner/work/LootAura/LootAura/node_modules/jsdom/lib/jsdom/living/generated/EventTarget.js:241:34)
    at Object.invokeGuardedCallbackDev (/home/runner/work/LootAura/LootAura/node_modules/react-dom/cjs/react-dom.development.js:4213:16)
    at invokeGuardedCallback (/home/runner/work/LootAura/LootAura/node_modules/react-dom/cjs/react-dom.development.js:4277:31)
    at reportUncaughtErrorInDEV (/home/runner/work/LootAura/LootAura/node_modules/react-dom/cjs/react-dom.development.js:22877:5)
    at captureCommitPhaseError (/home/runner/work/LootAura/LootAura/node_modules/react-dom/cjs/react-dom.development.js:27165:5) ReferenceError: ResizeObserver is not defined
    at /home/runner/work/LootAura/LootAura/components/SalesGrid.tsx:51:28
    at commitHookEffectListMount (/home/runner/work/LootAura/LootAura/node_modules/react-dom/cjs/react-dom.development.js:23189:26)
    at commitPassiveMountOnFiber (/home/runner/work/LootAura/LootAura/node_modules/react-dom/cjs/react-dom.development.js:24970:11)
    at commitPassiveMountEffects_complete (/home/runner/work/LootAura/LootAura/node_modules/react-dom/cjs/react-dom.development.js:24930:9)
    at commitPassiveMountEffects_begin (/home/runner/work/LootAura/LootAura/node_modules/react-dom/cjs/react-dom.development.js:24917:7)
    at commitPassiveMountEffects (/home/runner/work/LootAura/LootAura/node_modules/react-dom/cjs/react-dom.development.js:24905:3)
    at flushPassiveEffectsImpl (/home/runner/work/LootAura/LootAura/node_modules/react-dom/cjs/react-dom.development.js:27078:3)
    at flushPassiveEffects (/home/runner/work/LootAura/LootAura/node_modules/react-dom/cjs/react-dom.development.js:27023:14)
    at /home/runner/work/LootAura/LootAura/node_modules/react-dom/cjs/react-dom.development.js:26808:9
    at flushActQueue (/home/runner/work/LootAura/LootAura/node_modules/react/cjs/react.development.js:2667:24)
The above error occurred in the <SalesGrid> component:

    at SalesGrid (/home/runner/work/LootAura/LootAura/components/SalesGrid.tsx:11:3)
    at QueryClientProvider (file:///home/runner/work/LootAura/LootAura/node_modules/@tanstack/react-query/build/modern/QueryClientProvider.js:20:3)
    at wrapper (/home/runner/work/LootAura/LootAura/tests/utils/renderWithProviders.tsx:11:22)

Consider adding an error boundary to your tree to customize error handling behavior.
Visit https://reactjs.org/link/error-boundaries to learn more about error boundaries.

stderr | tests/components/SalesGrid.test.tsx > SalesGrid > sets correct data attributes
Error: Uncaught [ReferenceError: ResizeObserver is not defined]
    at reportException (/home/runner/work/LootAura/LootAura/node_modules/jsdom/lib/jsdom/living/helpers/runtime-script-errors.js:66:24)
    at innerInvokeEventListeners (/home/runner/work/LootAura/LootAura/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:353:9)
    at invokeEventListeners (/home/runner/work/LootAura/LootAura/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:286:3)
    at HTMLUnknownElementImpl._dispatch (/home/runner/work/LootAura/LootAura/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:233:9)
    at HTMLUnknownElementImpl.dispatchEvent (/home/runner/work/LootAura/LootAura/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:104:17)
    at HTMLUnknownElement.dispatchEvent (/home/runner/work/LootAura/LootAura/node_modules/jsdom/lib/jsdom/living/generated/EventTarget.js:241:34)
    at Object.invokeGuardedCallbackDev (/home/runner/work/LootAura/LootAura/node_modules/react-dom/cjs/react-dom.development.js:4213:16)
    at invokeGuardedCallback (/home/runner/work/LootAura/LootAura/node_modules/react-dom/cjs/react-dom.development.js:4277:31)
    at reportUncaughtErrorInDEV (/home/runner/work/LootAura/LootAura/node_modules/react-dom/cjs/react-dom.development.js:22877:5)
    at captureCommitPhaseError (/home/runner/work/LootAura/LootAura/node_modules/react-dom/cjs/react-dom.development.js:27165:5) ReferenceError: ResizeObserver is not defined
    at /home/runner/work/LootAura/LootAura/components/SalesGrid.tsx:51:28
    at commitHookEffectListMount (/home/runner/work/LootAura/LootAura/node_modules/react-dom/cjs/react-dom.development.js:23189:26)
    at commitPassiveMountOnFiber (/home/runner/work/LootAura/LootAura/node_modules/react-dom/cjs/react-dom.development.js:24970:11)
    at commitPassiveMountEffects_complete (/home/runner/work/LootAura/LootAura/node_modules/react-dom/cjs/react-dom.development.js:24930:9)
    at commitPassiveMountEffects_begin (/home/runner/work/LootAura/LootAura/node_modules/react-dom/cjs/react-dom.development.js:24917:7)
    at commitPassiveMountEffects (/home/runner/work/LootAura/LootAura/node_modules/react-dom/cjs/react-dom.development.js:24905:3)
    at flushPassiveEffectsImpl (/home/runner/work/LootAura/LootAura/node_modules/react-dom/cjs/react-dom.development.js:27078:3)
    at flushPassiveEffects (/home/runner/work/LootAura/LootAura/node_modules/react-dom/cjs/react-dom.development.js:27023:14)
    at /home/runner/work/LootAura/LootAura/node_modules/react-dom/cjs/react-dom.development.js:26808:9
    at flushActQueue (/home/runner/work/LootAura/LootAura/node_modules/react/cjs/react.development.js:2667:24)
The above error occurred in the <SalesGrid> component:

    at SalesGrid (/home/runner/work/LootAura/LootAura/components/SalesGrid.tsx:11:3)
    at QueryClientProvider (file:///home/runner/work/LootAura/LootAura/node_modules/@tanstack/react-query/build/modern/QueryClientProvider.js:20:3)
    at wrapper (/home/runner/work/LootAura/LootAura/tests/utils/renderWithProviders.tsx:11:22)

Consider adding an error boundary to your tree to customize error handling behavior.
Visit https://reactjs.org/link/error-boundaries to learn more about error boundaries.

 ❯ tests/components/SalesGrid.test.tsx (8 tests | 8 failed) 87ms
   × SalesGrid > renders sales cards when not loading and sales are present 48ms
     → ResizeObserver is not defined
   × SalesGrid > renders skeletons when loading and not in MAP authority 6ms
     → ResizeObserver is not defined
   × SalesGrid > renders empty state message when no sales and not loading 6ms
     → ResizeObserver is not defined
   × SalesGrid > does not render skeletons when in MAP authority, even if loading 4ms
     → ResizeObserver is not defined
   × SalesGrid > observes resize events and updates columns 5ms
     → ResizeObserver is not defined
   × SalesGrid > cleans up ResizeObserver on unmount 7ms
     → ResizeObserver is not defined
   × SalesGrid > applies custom className 6ms
     → ResizeObserver is not defined
   × SalesGrid > sets correct data attributes 5ms
     → ResizeObserver is not defined
 ✓ tests/unit/category-serialization.test.ts (16 tests) 10ms
 ✓ tests/unit/addSale.validation.test.ts (9 tests) 13ms
 ✓ tests/unit/dateBounds.test.ts (21 tests) 12ms
 ✓ tests/unit/gridLayout.test.ts (6 tests) 7ms
 ❯ tests/integration/addSale.insert.test.tsx (7 tests | 7 failed) 149ms
   × Add Sale Integration > should insert sale with geocoded coordinates 39ms
     → Invalid Chai property: toBeInTheDocument
   × Add Sale Integration > should handle geocoding failure gracefully 71ms
     → Invalid Chai property: toBeInTheDocument
   × Add Sale Integration > should validate required fields before submission 11ms
     → Invalid Chai property: toBeInTheDocument
   × Add Sale Integration > should show loading state during submission 4ms
     → Invalid Chai property: toBeInTheDocument
   × Add Sale Integration > should handle submission errors 11ms
     → Invalid Chai property: toBeInTheDocument
   × Add Sale Integration > should include owner_id in inserted data 8ms
     → Invalid Chai property: toBeInTheDocument
   × Add Sale Integration > should update React Query cache after successful creation 3ms
     → Invalid Chai property: toBeInTheDocument
 ✓ tests/unit/sanitize.test.ts (26 tests) 30ms
 ❯ tests/unit/env.test.ts (9 tests | 1 failed) 58ms
   × Environment Validation > should handle missing optional variables 8ms
     → expected undefined to be 'https://lootaura.app' // Object.is equality
 ✓ tests/unit/metadata.test.ts (8 tests) 24ms
 ❯ tests/stability/list.dom.spec.tsx (6 tests | 4 failed) 75ms
   × list.dom > should render list panel with correct data attribute 45ms
     → Invalid Chai property: toHaveAttribute
   × list.dom > should render sale cards as descendants of list panel 11ms
     → Invalid Chai property: toHaveAttribute
   × list.dom > should have grid wrapper classes on list panel 5ms
     → Invalid Chai property: toHaveClass
   × list.dom > should maintain grid structure with single card 4ms
     → Invalid Chai property: toHaveClass
 ✓ tests/unit/mapAuthorityQuery.test.ts (7 tests) 10ms
 ✓ tests/unit/resolveDatePreset.test.ts (13 tests) 9ms
 ✓ tests/integration/auth.session.test.tsx (12 tests) 8ms
stdout | tests/unit/geocode.fallback.test.ts > Geocoding Fallback > should geocode address using Nominatim
[usage] geocode call (count=1)

 ✓ tests/stability/visible.recompute.spec.ts (5 tests) 5ms
 ↓ tests/snapshots/gridContainer.snapshot.test.tsx (3 tests | 3 skipped)
stdout | tests/unit/geocode.fallback.test.ts > Geocoding Fallback > should return null when Nominatim fails
[usage] geocode call (count=2)

 ✓ tests/stability/arbiter.contract.spec.ts (4 tests) 5ms
 ✓ tests/unit/rateLimiter.test.ts (6 tests) 163ms
 ✓ tests/integration/rls.profiles.test.ts (13 tests) 8ms
 ✓ tests/unit/date-windows.test.ts (6 tests) 7ms
 ✓ tests/stability/server.predicate.spec.ts (5 tests) 6ms
stderr | tests/components/FavoriteButton.test.tsx > FavoriteButton > renders save button when not favorited
Error: Uncaught [Error: invariant expected app router to be mounted]
    at reportException (/home/runner/work/LootAura/LootAura/node_modules/jsdom/lib/jsdom/living/helpers/runtime-script-errors.js:66:24)
    at innerInvokeEventListeners (/home/runner/work/LootAura/LootAura/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:353:9)
    at invokeEventListeners (/home/runner/work/LootAura/LootAura/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:286:3)
    at HTMLUnknownElementImpl._dispatch (/home/runner/work/LootAura/LootAura/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:233:9)
    at HTMLUnknownElementImpl.dispatchEvent (/home/runner/work/LootAura/LootAura/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:104:17)
    at HTMLUnknownElement.dispatchEvent (/home/runner/work/LootAura/LootAura/node_modules/jsdom/lib/jsdom/living/generated/EventTarget.js:241:34)
    at Object.invokeGuardedCallbackDev (/home/runner/work/LootAura/LootAura/node_modules/react-dom/cjs/react-dom.development.js:4213:16)
    at invokeGuardedCallback (/home/runner/work/LootAura/LootAura/node_modules/react-dom/cjs/react-dom.development.js:4277:31)
    at beginWork$1 (/home/runner/work/LootAura/LootAura/node_modules/react-dom/cjs/react-dom.development.js:27490:7)
    at performUnitOfWork (/home/runner/work/LootAura/LootAura/node_modules/react-dom/cjs/react-dom.development.js:26599:12) Error: invariant expected app router to be mounted
    at Proxy.useRouter (/home/runner/work/LootAura/LootAura/node_modules/next/src/client/components/navigation.ts:113:11)
    at FavoriteButton (/home/runner/work/LootAura/LootAura/components/FavoriteButton.tsx:13:18)
    at renderWithHooks (/home/runner/work/LootAura/LootAura/node_modules/react-dom/cjs/react-dom.development.js:15486:18)
    at mountIndeterminateComponent (/home/runner/work/LootAura/LootAura/node_modules/react-dom/cjs/react-dom.development.js:20103:13)
    at beginWork (/home/runner/work/LootAura/LootAura/node_modules/react-dom/cjs/react-dom.development.js:21626:16)
    at HTMLUnknownElement.callCallback (/home/runner/work/LootAura/LootAura/node_modules/react-dom/cjs/react-dom.development.js:4164:14)
    at HTMLUnknownElement.callTheUserObjectsOperation (/home/runner/work/LootAura/LootAura/node_modules/jsdom/lib/jsdom/living/generated/EventListener.js:26:30)
    at innerInvokeEventListeners (/home/runner/work/LootAura/LootAura/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:350:25)
    at invokeEventListeners (/home/runner/work/LootAura/LootAura/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:286:3)
    at HTMLUnknownElementImpl._dispatch (/home/runner/work/LootAura/LootAura/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:233:9)
Error: Uncaught [Error: invariant expected app router to be mounted]
    at reportException (/home/runner/work/LootAura/LootAura/node_modules/jsdom/lib/jsdom/living/helpers/runtime-script-errors.js:66:24)
    at innerInvokeEventListeners (/home/runner/work/LootAura/LootAura/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:353:9)
    at invokeEventListeners (/home/runner/work/LootAura/LootAura/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:286:3)
    at HTMLUnknownElementImpl._dispatch (/home/runner/work/LootAura/LootAura/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:233:9)
    at HTMLUnknownElementImpl.dispatchEvent (/home/runner/work/LootAura/LootAura/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:104:17)
    at HTMLUnknownElement.dispatchEvent (/home/runner/work/LootAura/LootAura/node_modules/jsdom/lib/jsdom/living/generated/EventTarget.js:241:34)
    at Object.invokeGuardedCallbackDev (/home/runner/work/LootAura/LootAura/node_modules/react-dom/cjs/react-dom.development.js:4213:16)
    at invokeGuardedCallback (/home/runner/work/LootAura/LootAura/node_modules/react-dom/cjs/react-dom.development.js:4277:31)
    at beginWork$1 (/home/runner/work/LootAura/LootAura/node_modules/react-dom/cjs/react-dom.development.js:27490:7)
    at performUnitOfWork (/home/runner/work/LootAura/LootAura/node_modules/react-dom/cjs/react-dom.development.js:26599:12) Error: invariant expected app router to be mounted
    at Proxy.useRouter (/home/runner/work/LootAura/LootAura/node_modules/next/src/client/components/navigation.ts:113:11)
    at FavoriteButton (/home/runner/work/LootAura/LootAura/components/FavoriteButton.tsx:13:18)
    at renderWithHooks (/home/runner/work/LootAura/LootAura/node_modules/react-dom/cjs/react-dom.development.js:15486:18)
    at mountIndeterminateComponent (/home/runner/work/LootAura/LootAura/node_modules/react-dom/cjs/react-dom.development.js:20103:13)
    at beginWork (/home/runner/work/LootAura/LootAura/node_modules/react-dom/cjs/react-dom.development.js:21626:16)
    at HTMLUnknownElement.callCallback (/home/runner/work/LootAura/LootAura/node_modules/react-dom/cjs/react-dom.development.js:4164:14)
    at HTMLUnknownElement.callTheUserObjectsOperation (/home/runner/work/LootAura/LootAura/node_modules/jsdom/lib/jsdom/living/generated/EventListener.js:26:30)
    at innerInvokeEventListeners (/home/runner/work/LootAura/LootAura/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:350:25)
    at invokeEventListeners (/home/runner/work/LootAura/LootAura/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:286:3)
    at HTMLUnknownElementImpl._dispatch (/home/runner/work/LootAura/LootAura/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:233:9)
The above error occurred in the <FavoriteButton> component:

    at FavoriteButton (/home/runner/work/LootAura/LootAura/components/FavoriteButton.tsx:11:3)
    at QueryClientProvider (file:///home/runner/work/LootAura/LootAura/node_modules/@tanstack/react-query/build/modern/QueryClientProvider.js:20:3)
    at TestWrapper (/home/runner/work/LootAura/LootAura/tests/components/FavoriteButton.test.tsx:33:24)

Consider adding an error boundary to your tree to customize error handling behavior.
Visit https://reactjs.org/link/error-boundaries to learn more about error boundaries.

stderr | tests/components/FavoriteButton.test.tsx > FavoriteButton > renders saved button when favorited
Error: Uncaught [Error: invariant expected app router to be mounted]
    at reportException (/home/runner/work/LootAura/LootAura/node_modules/jsdom/lib/jsdom/living/helpers/runtime-script-errors.js:66:24)
    at innerInvokeEventListeners (/home/runner/work/LootAura/LootAura/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:353:9)
    at invokeEventListeners (/home/runner/work/LootAura/LootAura/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:286:3)
    at HTMLUnknownElementImpl._dispatch (/home/runner/work/LootAura/LootAura/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:233:9)
    at HTMLUnknownElementImpl.dispatchEvent (/home/runner/work/LootAura/LootAura/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:104:17)
    at HTMLUnknownElement.dispatchEvent (/home/runner/work/LootAura/LootAura/node_modules/jsdom/lib/jsdom/living/generated/EventTarget.js:241:34)
    at Object.invokeGuardedCallbackDev (/home/runner/work/LootAura/LootAura/node_modules/react-dom/cjs/react-dom.development.js:4213:16)
    at invokeGuardedCallback (/home/runner/work/LootAura/LootAura/node_modules/react-dom/cjs/react-dom.development.js:4277:31)
    at beginWork$1 (/home/runner/work/LootAura/LootAura/node_modules/react-dom/cjs/react-dom.development.js:27490:7)
    at performUnitOfWork (/home/runner/work/LootAura/LootAura/node_modules/react-dom/cjs/react-dom.development.js:26599:12) Error: invariant expected app router to be mounted
    at Proxy.useRouter (/home/runner/work/LootAura/LootAura/node_modules/next/src/client/components/navigation.ts:113:11)
    at FavoriteButton (/home/runner/work/LootAura/LootAura/components/FavoriteButton.tsx:13:18)
    at renderWithHooks (/home/runner/work/LootAura/LootAura/node_modules/react-dom/cjs/react-dom.development.js:15486:18)
    at mountIndeterminateComponent (/home/runner/work/LootAura/LootAura/node_modules/react-dom/cjs/react-dom.development.js:20103:13)
    at beginWork (/home/runner/work/LootAura/LootAura/node_modules/react-dom/cjs/react-dom.development.js:21626:16)
    at HTMLUnknownElement.callCallback (/home/runner/work/LootAura/LootAura/node_modules/react-dom/cjs/react-dom.development.js:4164:14)
    at HTMLUnknownElement.callTheUserObjectsOperation (/home/runner/work/LootAura/LootAura/node_modules/jsdom/lib/jsdom/living/generated/EventListener.js:26:30)
    at innerInvokeEventListeners (/home/runner/work/LootAura/LootAura/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:350:25)
    at invokeEventListeners (/home/runner/work/LootAura/LootAura/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:286:3)
    at HTMLUnknownElementImpl._dispatch (/home/runner/work/LootAura/LootAura/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:233:9)
Error: Uncaught [Error: invariant expected app router to be mounted]
    at reportException (/home/runner/work/LootAura/LootAura/node_modules/jsdom/lib/jsdom/living/helpers/runtime-script-errors.js:66:24)
    at innerInvokeEventListeners (/home/runner/work/LootAura/LootAura/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:353:9)
    at invokeEventListeners (/home/runner/work/LootAura/LootAura/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:286:3)
    at HTMLUnknownElementImpl._dispatch (/home/runner/work/LootAura/LootAura/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:233:9)
    at HTMLUnknownElementImpl.dispatchEvent (/home/runner/work/LootAura/LootAura/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:104:17)
    at HTMLUnknownElement.dispatchEvent (/home/runner/work/LootAura/LootAura/node_modules/jsdom/lib/jsdom/living/generated/EventTarget.js:241:34)
    at Object.invokeGuardedCallbackDev (/home/runner/work/LootAura/LootAura/node_modules/react-dom/cjs/react-dom.development.js:4213:16)
    at invokeGuardedCallback (/home/runner/work/LootAura/LootAura/node_modules/react-dom/cjs/react-dom.development.js:4277:31)
    at beginWork$1 (/home/runner/work/LootAura/LootAura/node_modules/react-dom/cjs/react-dom.development.js:27490:7)
    at performUnitOfWork (/home/runner/work/LootAura/LootAura/node_modules/react-dom/cjs/react-dom.development.js:26599:12) Error: invariant expected app router to be mounted
    at Proxy.useRouter (/home/runner/work/LootAura/LootAura/node_modules/next/src/client/components/navigation.ts:113:11)
    at FavoriteButton (/home/runner/work/LootAura/LootAura/components/FavoriteButton.tsx:13:18)
    at renderWithHooks (/home/runner/work/LootAura/LootAura/node_modules/react-dom/cjs/react-dom.development.js:15486:18)
    at mountIndeterminateComponent (/home/runner/work/LootAura/LootAura/node_modules/react-dom/cjs/react-dom.development.js:20103:13)
    at beginWork (/home/runner/work/LootAura/LootAura/node_modules/react-dom/cjs/react-dom.development.js:21626:16)
    at HTMLUnknownElement.callCallback (/home/runner/work/LootAura/LootAura/node_modules/react-dom/cjs/react-dom.development.js:4164:14)
    at HTMLUnknownElement.callTheUserObjectsOperation (/home/runner/work/LootAura/LootAura/node_modules/jsdom/lib/jsdom/living/generated/EventListener.js:26:30)
    at innerInvokeEventListeners (/home/runner/work/LootAura/LootAura/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:350:25)
    at invokeEventListeners (/home/runner/work/LootAura/LootAura/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:286:3)
    at HTMLUnknownElementImpl._dispatch (/home/runner/work/LootAura/LootAura/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:233:9)
The above error occurred in the <FavoriteButton> component:

    at FavoriteButton (/home/runner/work/LootAura/LootAura/components/FavoriteButton.tsx:11:3)
    at QueryClientProvider (file:///home/runner/work/LootAura/LootAura/node_modules/@tanstack/react-query/build/modern/QueryClientProvider.js:20:3)
    at TestWrapper (/home/runner/work/LootAura/LootAura/tests/components/FavoriteButton.test.tsx:33:24)

Consider adding an error boundary to your tree to customize error handling behavior.
Visit https://reactjs.org/link/error-boundaries to learn more about error boundaries.

stderr | tests/components/FavoriteButton.test.tsx > FavoriteButton > calls toggle function when clicked
Error: Uncaught [Error: invariant expected app router to be mounted]
    at reportException (/home/runner/work/LootAura/LootAura/node_modules/jsdom/lib/jsdom/living/helpers/runtime-script-errors.js:66:24)
    at innerInvokeEventListeners (/home/runner/work/LootAura/LootAura/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:353:9)
    at invokeEventListeners (/home/runner/work/LootAura/LootAura/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:286:3)
    at HTMLUnknownElementImpl._dispatch (/home/runner/work/LootAura/LootAura/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:233:9)
    at HTMLUnknownElementImpl.dispatchEvent (/home/runner/work/LootAura/LootAura/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:104:17)
    at HTMLUnknownElement.dispatchEvent (/home/runner/work/LootAura/LootAura/node_modules/jsdom/lib/jsdom/living/generated/EventTarget.js:241:34)
    at Object.invokeGuardedCallbackDev (/home/runner/work/LootAura/LootAura/node_modules/react-dom/cjs/react-dom.development.js:4213:16)
    at invokeGuardedCallback (/home/runner/work/LootAura/LootAura/node_modules/react-dom/cjs/react-dom.development.js:4277:31)
    at beginWork$1 (/home/runner/work/LootAura/LootAura/node_modules/react-dom/cjs/react-dom.development.js:27490:7)
    at performUnitOfWork (/home/runner/work/LootAura/LootAura/node_modules/react-dom/cjs/react-dom.development.js:26599:12) Error: invariant expected app router to be mounted
    at Proxy.useRouter (/home/runner/work/LootAura/LootAura/node_modules/next/src/client/components/navigation.ts:113:11)
    at FavoriteButton (/home/runner/work/LootAura/LootAura/components/FavoriteButton.tsx:13:18)
    at renderWithHooks (/home/runner/work/LootAura/LootAura/node_modules/react-dom/cjs/react-dom.development.js:15486:18)
    at mountIndeterminateComponent (/home/runner/work/LootAura/LootAura/node_modules/react-dom/cjs/react-dom.development.js:20103:13)
    at beginWork (/home/runner/work/LootAura/LootAura/node_modules/react-dom/cjs/react-dom.development.js:21626:16)
    at HTMLUnknownElement.callCallback (/home/runner/work/LootAura/LootAura/node_modules/react-dom/cjs/react-dom.development.js:4164:14)
    at HTMLUnknownElement.callTheUserObjectsOperation (/home/runner/work/LootAura/LootAura/node_modules/jsdom/lib/jsdom/living/generated/EventListener.js:26:30)
    at innerInvokeEventListeners (/home/runner/work/LootAura/LootAura/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:350:25)
    at invokeEventListeners (/home/runner/work/LootAura/LootAura/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:286:3)
    at HTMLUnknownElementImpl._dispatch (/home/runner/work/LootAura/LootAura/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:233:9)
Error: Uncaught [Error: invariant expected app router to be mounted]
    at reportException (/home/runner/work/LootAura/LootAura/node_modules/jsdom/lib/jsdom/living/helpers/runtime-script-errors.js:66:24)
    at innerInvokeEventListeners (/home/runner/work/LootAura/LootAura/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:353:9)
    at invokeEventListeners (/home/runner/work/LootAura/LootAura/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:286:3)
    at HTMLUnknownElementImpl._dispatch (/home/runner/work/LootAura/LootAura/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:233:9)
    at HTMLUnknownElementImpl.dispatchEvent (/home/runner/work/LootAura/LootAura/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:104:17)
    at HTMLUnknownElement.dispatchEvent (/home/runner/work/LootAura/LootAura/node_modules/jsdom/lib/jsdom/living/generated/EventTarget.js:241:34)
    at Object.invokeGuardedCallbackDev (/home/runner/work/LootAura/LootAura/node_modules/react-dom/cjs/react-dom.development.js:4213:16)
    at invokeGuardedCallback (/home/runner/work/LootAura/LootAura/node_modules/react-dom/cjs/react-dom.development.js:4277:31)
    at beginWork$1 (/home/runner/work/LootAura/LootAura/node_modules/react-dom/cjs/react-dom.development.js:27490:7)
    at performUnitOfWork (/home/runner/work/LootAura/LootAura/node_modules/react-dom/cjs/react-dom.development.js:26599:12) Error: invariant expected app router to be mounted
    at Proxy.useRouter (/home/runner/work/LootAura/LootAura/node_modules/next/src/client/components/navigation.ts:113:11)
    at FavoriteButton (/home/runner/work/LootAura/LootAura/components/FavoriteButton.tsx:13:18)
    at renderWithHooks (/home/runner/work/LootAura/LootAura/node_modules/react-dom/cjs/react-dom.development.js:15486:18)
    at mountIndeterminateComponent (/home/runner/work/LootAura/LootAura/node_modules/react-dom/cjs/react-dom.development.js:20103:13)
    at beginWork (/home/runner/work/LootAura/LootAura/node_modules/react-dom/cjs/react-dom.development.js:21626:16)
    at HTMLUnknownElement.callCallback (/home/runner/work/LootAura/LootAura/node_modules/react-dom/cjs/react-dom.development.js:4164:14)
    at HTMLUnknownElement.callTheUserObjectsOperation (/home/runner/work/LootAura/LootAura/node_modules/jsdom/lib/jsdom/living/generated/EventListener.js:26:30)
    at innerInvokeEventListeners (/home/runner/work/LootAura/LootAura/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:350:25)
    at invokeEventListeners (/home/runner/work/LootAura/LootAura/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:286:3)
    at HTMLUnknownElementImpl._dispatch (/home/runner/work/LootAura/LootAura/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:233:9)
The above error occurred in the <FavoriteButton> component:

    at FavoriteButton (/home/runner/work/LootAura/LootAura/components/FavoriteButton.tsx:11:3)
    at QueryClientProvider (file:///home/runner/work/LootAura/LootAura/node_modules/@tanstack/react-query/build/modern/QueryClientProvider.js:20:3)
    at TestWrapper (/home/runner/work/LootAura/LootAura/tests/components/FavoriteButton.test.tsx:33:24)

Consider adding an error boundary to your tree to customize error handling behavior.
Visit https://reactjs.org/link/error-boundaries to learn more about error boundaries.

stderr | tests/components/FavoriteButton.test.tsx > FavoriteButton > shows loading state when pending
Error: Uncaught [Error: invariant expected app router to be mounted]
    at reportException (/home/runner/work/LootAura/LootAura/node_modules/jsdom/lib/jsdom/living/helpers/runtime-script-errors.js:66:24)
    at innerInvokeEventListeners (/home/runner/work/LootAura/LootAura/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:353:9)
    at invokeEventListeners (/home/runner/work/LootAura/LootAura/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:286:3)
    at HTMLUnknownElementImpl._dispatch (/home/runner/work/LootAura/LootAura/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:233:9)
    at HTMLUnknownElementImpl.dispatchEvent (/home/runner/work/LootAura/LootAura/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:104:17)
    at HTMLUnknownElement.dispatchEvent (/home/runner/work/LootAura/LootAura/node_modules/jsdom/lib/jsdom/living/generated/EventTarget.js:241:34)
    at Object.invokeGuardedCallbackDev (/home/runner/work/LootAura/LootAura/node_modules/react-dom/cjs/react-dom.development.js:4213:16)
    at invokeGuardedCallback (/home/runner/work/LootAura/LootAura/node_modules/react-dom/cjs/react-dom.development.js:4277:31)
    at beginWork$1 (/home/runner/work/LootAura/LootAura/node_modules/react-dom/cjs/react-dom.development.js:27490:7)
    at performUnitOfWork (/home/runner/work/LootAura/LootAura/node_modules/react-dom/cjs/react-dom.development.js:26599:12) Error: invariant expected app router to be mounted
    at Proxy.useRouter (/home/runner/work/LootAura/LootAura/node_modules/next/src/client/components/navigation.ts:113:11)
    at FavoriteButton (/home/runner/work/LootAura/LootAura/components/FavoriteButton.tsx:13:18)
    at renderWithHooks (/home/runner/work/LootAura/LootAura/node_modules/react-dom/cjs/react-dom.development.js:15486:18)
    at mountIndeterminateComponent (/home/runner/work/LootAura/LootAura/node_modules/react-dom/cjs/react-dom.development.js:20103:13)
    at beginWork (/home/runner/work/LootAura/LootAura/node_modules/react-dom/cjs/react-dom.development.js:21626:16)
    at HTMLUnknownElement.callCallback (/home/runner/work/LootAura/LootAura/node_modules/react-dom/cjs/react-dom.development.js:4164:14)
    at HTMLUnknownElement.callTheUserObjectsOperation (/home/runner/work/LootAura/LootAura/node_modules/jsdom/lib/jsdom/living/generated/EventListener.js:26:30)
    at innerInvokeEventListeners (/home/runner/work/LootAura/LootAura/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:350:25)
    at invokeEventListeners (/home/runner/work/LootAura/LootAura/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:286:3)
    at HTMLUnknownElementImpl._dispatch (/home/runner/work/LootAura/LootAura/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:233:9)
Error: Uncaught [Error: invariant expected app router to be mounted]
    at reportException (/home/runner/work/LootAura/LootAura/node_modules/jsdom/lib/jsdom/living/helpers/runtime-script-errors.js:66:24)
    at innerInvokeEventListeners (/home/runner/work/LootAura/LootAura/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:353:9)
    at invokeEventListeners (/home/runner/work/LootAura/LootAura/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:286:3)
    at HTMLUnknownElementImpl._dispatch (/home/runner/work/LootAura/LootAura/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:233:9)
    at HTMLUnknownElementImpl.dispatchEvent (/home/runner/work/LootAura/LootAura/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:104:17)
    at HTMLUnknownElement.dispatchEvent (/home/runner/work/LootAura/LootAura/node_modules/jsdom/lib/jsdom/living/generated/EventTarget.js:241:34)
    at Object.invokeGuardedCallbackDev (/home/runner/work/LootAura/LootAura/node_modules/react-dom/cjs/react-dom.development.js:4213:16)
    at invokeGuardedCallback (/home/runner/work/LootAura/LootAura/node_modules/react-dom/cjs/react-dom.development.js:4277:31)
    at beginWork$1 (/home/runner/work/LootAura/LootAura/node_modules/react-dom/cjs/react-dom.development.js:27490:7)
    at performUnitOfWork (/home/runner/work/LootAura/LootAura/node_modules/react-dom/cjs/react-dom.development.js:26599:12) Error: invariant expected app router to be mounted
    at Proxy.useRouter (/home/runner/work/LootAura/LootAura/node_modules/next/src/client/components/navigation.ts:113:11)
    at FavoriteButton (/home/runner/work/LootAura/LootAura/components/FavoriteButton.tsx:13:18)
    at renderWithHooks (/home/runner/work/LootAura/LootAura/node_modules/react-dom/cjs/react-dom.development.js:15486:18)
    at mountIndeterminateComponent (/home/runner/work/LootAura/LootAura/node_modules/react-dom/cjs/react-dom.development.js:20103:13)
    at beginWork (/home/runner/work/LootAura/LootAura/node_modules/react-dom/cjs/react-dom.development.js:21626:16)
    at HTMLUnknownElement.callCallback (/home/runner/work/LootAura/LootAura/node_modules/react-dom/cjs/react-dom.development.js:4164:14)
    at HTMLUnknownElement.callTheUserObjectsOperation (/home/runner/work/LootAura/LootAura/node_modules/jsdom/lib/jsdom/living/generated/EventListener.js:26:30)
    at innerInvokeEventListeners (/home/runner/work/LootAura/LootAura/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:350:25)
    at invokeEventListeners (/home/runner/work/LootAura/LootAura/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:286:3)
    at HTMLUnknownElementImpl._dispatch (/home/runner/work/LootAura/LootAura/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:233:9)
The above error occurred in the <FavoriteButton> component:

    at FavoriteButton (/home/runner/work/LootAura/LootAura/components/FavoriteButton.tsx:11:3)
    at QueryClientProvider (file:///home/runner/work/LootAura/LootAura/node_modules/@tanstack/react-query/build/modern/QueryClientProvider.js:20:3)
    at TestWrapper (/home/runner/work/LootAura/LootAura/tests/components/FavoriteButton.test.tsx:33:24)

Consider adding an error boundary to your tree to customize error handling behavior.
Visit https://reactjs.org/link/error-boundaries to learn more about error boundaries.

stderr | tests/components/FavoriteButton.test.tsx > FavoriteButton > has correct ARIA attributes
Error: Uncaught [Error: invariant expected app router to be mounted]
    at reportException (/home/runner/work/LootAura/LootAura/node_modules/jsdom/lib/jsdom/living/helpers/runtime-script-errors.js:66:24)
    at innerInvokeEventListeners (/home/runner/work/LootAura/LootAura/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:353:9)
    at invokeEventListeners (/home/runner/work/LootAura/LootAura/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:286:3)
    at HTMLUnknownElementImpl._dispatch (/home/runner/work/LootAura/LootAura/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:233:9)
    at HTMLUnknownElementImpl.dispatchEvent (/home/runner/work/LootAura/LootAura/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:104:17)
    at HTMLUnknownElement.dispatchEvent (/home/runner/work/LootAura/LootAura/node_modules/jsdom/lib/jsdom/living/generated/EventTarget.js:241:34)
    at Object.invokeGuardedCallbackDev (/home/runner/work/LootAura/LootAura/node_modules/react-dom/cjs/react-dom.development.js:4213:16)
    at invokeGuardedCallback (/home/runner/work/LootAura/LootAura/node_modules/react-dom/cjs/react-dom.development.js:4277:31)
    at beginWork$1 (/home/runner/work/LootAura/LootAura/node_modules/react-dom/cjs/react-dom.development.js:27490:7)
    at performUnitOfWork (/home/runner/work/LootAura/LootAura/node_modules/react-dom/cjs/react-dom.development.js:26599:12) Error: invariant expected app router to be mounted
    at Proxy.useRouter (/home/runner/work/LootAura/LootAura/node_modules/next/src/client/components/navigation.ts:113:11)
    at FavoriteButton (/home/runner/work/LootAura/LootAura/components/FavoriteButton.tsx:13:18)
    at renderWithHooks (/home/runner/work/LootAura/LootAura/node_modules/react-dom/cjs/react-dom.development.js:15486:18)
    at mountIndeterminateComponent (/home/runner/work/LootAura/LootAura/node_modules/react-dom/cjs/react-dom.development.js:20103:13)
    at beginWork (/home/runner/work/LootAura/LootAura/node_modules/react-dom/cjs/react-dom.development.js:21626:16)
    at HTMLUnknownElement.callCallback (/home/runner/work/LootAura/LootAura/node_modules/react-dom/cjs/react-dom.development.js:4164:14)
    at HTMLUnknownElement.callTheUserObjectsOperation (/home/runner/work/LootAura/LootAura/node_modules/jsdom/lib/jsdom/living/generated/EventListener.js:26:30)
    at innerInvokeEventListeners (/home/runner/work/LootAura/LootAura/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:350:25)
    at invokeEventListeners (/home/runner/work/LootAura/LootAura/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:286:3)
    at HTMLUnknownElementImpl._dispatch (/home/runner/work/LootAura/LootAura/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:233:9)
Error: Uncaught [Error: invariant expected app router to be mounted]
    at reportException (/home/runner/work/LootAura/LootAura/node_modules/jsdom/lib/jsdom/living/helpers/runtime-script-errors.js:66:24)
    at innerInvokeEventListeners (/home/runner/work/LootAura/LootAura/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:353:9)
    at invokeEventListeners (/home/runner/work/LootAura/LootAura/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:286:3)
    at HTMLUnknownElementImpl._dispatch (/home/runner/work/LootAura/LootAura/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:233:9)
    at HTMLUnknownElementImpl.dispatchEvent (/home/runner/work/LootAura/LootAura/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:104:17)
    at HTMLUnknownElement.dispatchEvent (/home/runner/work/LootAura/LootAura/node_modules/jsdom/lib/jsdom/living/generated/EventTarget.js:241:34)
    at Object.invokeGuardedCallbackDev (/home/runner/work/LootAura/LootAura/node_modules/react-dom/cjs/react-dom.development.js:4213:16)
    at invokeGuardedCallback (/home/runner/work/LootAura/LootAura/node_modules/react-dom/cjs/react-dom.development.js:4277:31)
    at beginWork$1 (/home/runner/work/LootAura/LootAura/node_modules/react-dom/cjs/react-dom.development.js:27490:7)
    at performUnitOfWork (/home/runner/work/LootAura/LootAura/node_modules/react-dom/cjs/react-dom.development.js:26599:12) Error: invariant expected app router to be mounted
    at Proxy.useRouter (/home/runner/work/LootAura/LootAura/node_modules/next/src/client/components/navigation.ts:113:11)
    at FavoriteButton (/home/runner/work/LootAura/LootAura/components/FavoriteButton.tsx:13:18)
    at renderWithHooks (/home/runner/work/LootAura/LootAura/node_modules/react-dom/cjs/react-dom.development.js:15486:18)
    at mountIndeterminateComponent (/home/runner/work/LootAura/LootAura/node_modules/react-dom/cjs/react-dom.development.js:20103:13)
    at beginWork (/home/runner/work/LootAura/LootAura/node_modules/react-dom/cjs/react-dom.development.js:21626:16)
    at HTMLUnknownElement.callCallback (/home/runner/work/LootAura/LootAura/node_modules/react-dom/cjs/react-dom.development.js:4164:14)
    at HTMLUnknownElement.callTheUserObjectsOperation (/home/runner/work/LootAura/LootAura/node_modules/jsdom/lib/jsdom/living/generated/EventListener.js:26:30)
    at innerInvokeEventListeners (/home/runner/work/LootAura/LootAura/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:350:25)
    at invokeEventListeners (/home/runner/work/LootAura/LootAura/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:286:3)
    at HTMLUnknownElementImpl._dispatch (/home/runner/work/LootAura/LootAura/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:233:9)
The above error occurred in the <FavoriteButton> component:

    at FavoriteButton (/home/runner/work/LootAura/LootAura/components/FavoriteButton.tsx:11:3)
    at QueryClientProvider (file:///home/runner/work/LootAura/LootAura/node_modules/@tanstack/react-query/build/modern/QueryClientProvider.js:20:3)
    at TestWrapper (/home/runner/work/LootAura/LootAura/tests/components/FavoriteButton.test.tsx:33:24)

Consider adding an error boundary to your tree to customize error handling behavior.
Visit https://reactjs.org/link/error-boundaries to learn more about error boundaries.

 ❯ tests/components/FavoriteButton.test.tsx (5 tests | 5 failed) 43ms
   × FavoriteButton > renders save button when not favorited 27ms
     → invariant expected app router to be mounted
   × FavoriteButton > renders saved button when favorited 4ms
     → invariant expected app router to be mounted
   × FavoriteButton > calls toggle function when clicked 3ms
     → invariant expected app router to be mounted
   × FavoriteButton > shows loading state when pending 3ms
     → invariant expected app router to be mounted
   × FavoriteButton > has correct ARIA attributes 4ms
     → invariant expected app router to be mounted
stdout | tests/unit/geocode.fallback.test.ts > Geocoding Fallback > should handle Nominatim rate limiting gracefully
[usage] geocode call (count=4)

stderr | tests/unit/categoryContract.test.ts > Category Contract > toDbSet > should return normalized UI tokens when no mapping exists
[CATEGORY CONTRACT] No DB mapping cache available, using normalized UI tokens

stdout | tests/unit/categoryContract.test.ts > Category Contract > toDbSet > should apply DB mapping when available
[CATEGORY CONTRACT] Built DB mapping: 3 mappings

stdout | tests/unit/categoryContract.test.ts > Category Contract > buildDbMapping > should build mapping from DB categories
[CATEGORY CONTRACT] Built DB mapping: 4 mappings

stdout | tests/unit/categoryContract.test.ts > Category Contract > buildDbMapping > should handle empty DB categories
[CATEGORY CONTRACT] Built DB mapping: 0 mappings

stdout | tests/unit/categoryContract.test.ts > Category Contract > hasDbMapping > should return true for mapped categories
[CATEGORY CONTRACT] Built DB mapping: 1 mappings

 ✓ tests/unit/categoryContract.test.ts (10 tests) 9ms
 ✓ tests/stability/filters.url-parity.spec.ts (3 tests) 6ms
 ✓ tests/unit/profile.upsert.test.ts (9 tests) 7ms
stdout | tests/integration/sales-list.spec.tsx > SalesList Integration > should render sales list with proper grid layout
[DOM] list item rendered id= 1
[DOM] list item rendered id= 2
[DOM] item mounts id= 1
[DOM] item mounts id= 2
[DOM] list item rendered id= 1
[DOM] list item rendered id= 2
[DOM] item mounts id= 1
[DOM] item mounts id= 2

stderr | tests/integration/sales-list.spec.tsx > SalesList Integration > should render sales list with proper grid layout
Error: Uncaught [Error: invariant expected app router to be mounted]
    at reportException (/home/runner/work/LootAura/LootAura/node_modules/jsdom/lib/jsdom/living/helpers/runtime-script-errors.js:66:24)
    at innerInvokeEventListeners (/home/runner/work/LootAura/LootAura/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:353:9)
    at invokeEventListeners (/home/runner/work/LootAura/LootAura/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:286:3)
    at HTMLUnknownElementImpl._dispatch (/home/runner/work/LootAura/LootAura/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:233:9)
    at HTMLUnknownElementImpl.dispatchEvent (/home/runner/work/LootAura/LootAura/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:104:17)
    at HTMLUnknownElement.dispatchEvent (/home/runner/work/LootAura/LootAura/node_modules/jsdom/lib/jsdom/living/generated/EventTarget.js:241:34)
    at Object.invokeGuardedCallbackDev (/home/runner/work/LootAura/LootAura/node_modules/react-dom/cjs/react-dom.development.js:4213:16)
    at invokeGuardedCallback (/home/runner/work/LootAura/LootAura/node_modules/react-dom/cjs/react-dom.development.js:4277:31)
    at beginWork$1 (/home/runner/work/LootAura/LootAura/node_modules/react-dom/cjs/react-dom.development.js:27490:7)
    at performUnitOfWork (/home/runner/work/LootAura/LootAura/node_modules/react-dom/cjs/react-dom.development.js:26599:12) Error: invariant expected app router to be mounted
    at Proxy.useRouter (/home/runner/work/LootAura/LootAura/node_modules/next/src/client/components/navigation.ts:113:11)
    at FavoriteButton (/home/runner/work/LootAura/LootAura/components/FavoriteButton.tsx:13:18)
    at renderWithHooks (/home/runner/work/LootAura/LootAura/node_modules/react-dom/cjs/react-dom.development.js:15486:18)
    at mountIndeterminateComponent (/home/runner/work/LootAura/LootAura/node_modules/react-dom/cjs/react-dom.development.js:20103:13)
    at beginWork (/home/runner/work/LootAura/LootAura/node_modules/react-dom/cjs/react-dom.development.js:21626:16)
    at HTMLUnknownElement.callCallback (/home/runner/work/LootAura/LootAura/node_modules/react-dom/cjs/react-dom.development.js:4164:14)
    at HTMLUnknownElement.callTheUserObjectsOperation (/home/runner/work/LootAura/LootAura/node_modules/jsdom/lib/jsdom/living/generated/EventListener.js:26:30)
    at innerInvokeEventListeners (/home/runner/work/LootAura/LootAura/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:350:25)
    at invokeEventListeners (/home/runner/work/LootAura/LootAura/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:286:3)
    at HTMLUnknownElementImpl._dispatch (/home/runner/work/LootAura/LootAura/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:233:9)
Error: Uncaught [Error: invariant expected app router to be mounted]
    at reportException (/home/runner/work/LootAura/LootAura/node_modules/jsdom/lib/jsdom/living/helpers/runtime-script-errors.js:66:24)
    at innerInvokeEventListeners (/home/runner/work/LootAura/LootAura/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:353:9)
    at invokeEventListeners (/home/runner/work/LootAura/LootAura/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:286:3)
    at HTMLUnknownElementImpl._dispatch (/home/runner/work/LootAura/LootAura/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:233:9)
    at HTMLUnknownElementImpl.dispatchEvent (/home/runner/work/LootAura/LootAura/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:104:17)
    at HTMLUnknownElement.dispatchEvent (/home/runner/work/LootAura/LootAura/node_modules/jsdom/lib/jsdom/living/generated/EventTarget.js:241:34)
    at Object.invokeGuardedCallbackDev (/home/runner/work/LootAura/LootAura/node_modules/react-dom/cjs/react-dom.development.js:4213:16)
    at invokeGuardedCallback (/home/runner/work/LootAura/LootAura/node_modules/react-dom/cjs/react-dom.development.js:4277:31)
    at beginWork$1 (/home/runner/work/LootAura/LootAura/node_modules/react-dom/cjs/react-dom.development.js:27490:7)
    at performUnitOfWork (/home/runner/work/LootAura/LootAura/node_modules/react-dom/cjs/react-dom.development.js:26599:12) Error: invariant expected app router to be mounted
    at Proxy.useRouter (/home/runner/work/LootAura/LootAura/node_modules/next/src/client/components/navigation.ts:113:11)
    at FavoriteButton (/home/runner/work/LootAura/LootAura/components/FavoriteButton.tsx:13:18)
    at renderWithHooks (/home/runner/work/LootAura/LootAura/node_modules/react-dom/cjs/react-dom.development.js:15486:18)
    at mountIndeterminateComponent (/home/runner/work/LootAura/LootAura/node_modules/react-dom/cjs/react-dom.development.js:20103:13)
    at beginWork (/home/runner/work/LootAura/LootAura/node_modules/react-dom/cjs/react-dom.development.js:21626:16)
    at HTMLUnknownElement.callCallback (/home/runner/work/LootAura/LootAura/node_modules/react-dom/cjs/react-dom.development.js:4164:14)
    at HTMLUnknownElement.callTheUserObjectsOperation (/home/runner/work/LootAura/LootAura/node_modules/jsdom/lib/jsdom/living/generated/EventListener.js:26:30)
    at innerInvokeEventListeners (/home/runner/work/LootAura/LootAura/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:350:25)
    at invokeEventListeners (/home/runner/work/LootAura/LootAura/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:286:3)
    at HTMLUnknownElementImpl._dispatch (/home/runner/work/LootAura/LootAura/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:233:9)
Error: Uncaught [Error: invariant expected app router to be mounted]
    at reportException (/home/runner/work/LootAura/LootAura/node_modules/jsdom/lib/jsdom/living/helpers/runtime-script-errors.js:66:24)
    at innerInvokeEventListeners (/home/runner/work/LootAura/LootAura/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:353:9)
    at invokeEventListeners (/home/runner/work/LootAura/LootAura/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:286:3)
    at HTMLUnknownElementImpl._dispatch (/home/runner/work/LootAura/LootAura/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:233:9)
    at HTMLUnknownElementImpl.dispatchEvent (/home/runner/work/LootAura/LootAura/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:104:17)
    at HTMLUnknownElement.dispatchEvent (/home/runner/work/LootAura/LootAura/node_modules/jsdom/lib/jsdom/living/generated/EventTarget.js:241:34)
    at Object.invokeGuardedCallbackDev (/home/runner/work/LootAura/LootAura/node_modules/react-dom/cjs/react-dom.development.js:4213:16)
    at invokeGuardedCallback (/home/runner/work/LootAura/LootAura/node_modules/react-dom/cjs/react-dom.development.js:4277:31)
    at beginWork$1 (/home/runner/work/LootAura/LootAura/node_modules/react-dom/cjs/react-dom.development.js:27490:7)
    at performUnitOfWork (/home/runner/work/LootAura/LootAura/node_modules/react-dom/cjs/react-dom.development.js:26599:12) Error: invariant expected app router to be mounted
    at Proxy.useRouter (/home/runner/work/LootAura/LootAura/node_modules/next/src/client/components/navigation.ts:113:11)
    at FavoriteButton (/home/runner/work/LootAura/LootAura/components/FavoriteButton.tsx:13:18)
    at renderWithHooks (/home/runner/work/LootAura/LootAura/node_modules/react-dom/cjs/react-dom.development.js:15486:18)
    at mountIndeterminateComponent (/home/runner/work/LootAura/LootAura/node_modules/react-dom/cjs/react-dom.development.js:20103:13)
    at beginWork (/home/runner/work/LootAura/LootAura/node_modules/react-dom/cjs/react-dom.development.js:21626:16)
    at HTMLUnknownElement.callCallback (/home/runner/work/LootAura/LootAura/node_modules/react-dom/cjs/react-dom.development.js:4164:14)
    at HTMLUnknownElement.callTheUserObjectsOperation (/home/runner/work/LootAura/LootAura/node_modules/jsdom/lib/jsdom/living/generated/EventListener.js:26:30)
    at innerInvokeEventListeners (/home/runner/work/LootAura/LootAura/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:350:25)
    at invokeEventListeners (/home/runner/work/LootAura/LootAura/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:286:3)
    at HTMLUnknownElementImpl._dispatch (/home/runner/work/LootAura/LootAura/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:233:9)
Error: Uncaught [Error: invariant expected app router to be mounted]
    at reportException (/home/runner/work/LootAura/LootAura/node_modules/jsdom/lib/jsdom/living/helpers/runtime-script-errors.js:66:24)
    at innerInvokeEventListeners (/home/runner/work/LootAura/LootAura/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:353:9)
    at invokeEventListeners (/home/runner/work/LootAura/LootAura/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:286:3)
    at HTMLUnknownElementImpl._dispatch (/home/runner/work/LootAura/LootAura/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:233:9)
    at HTMLUnknownElementImpl.dispatchEvent (/home/runner/work/LootAura/LootAura/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:104:17)
    at HTMLUnknownElement.dispatchEvent (/home/runner/work/LootAura/LootAura/node_modules/jsdom/lib/jsdom/living/generated/EventTarget.js:241:34)
    at Object.invokeGuardedCallbackDev (/home/runner/work/LootAura/LootAura/node_modules/react-dom/cjs/react-dom.development.js:4213:16)
    at invokeGuardedCallback (/home/runner/work/LootAura/LootAura/node_modules/react-dom/cjs/react-dom.development.js:4277:31)
    at beginWork$1 (/home/runner/work/LootAura/LootAura/node_modules/react-dom/cjs/react-dom.development.js:27490:7)
    at performUnitOfWork (/home/runner/work/LootAura/LootAura/node_modules/react-dom/cjs/react-dom.development.js:26599:12) Error: invariant expected app router to be mounted
    at Proxy.useRouter (/home/runner/work/LootAura/LootAura/node_modules/next/src/client/components/navigation.ts:113:11)
    at FavoriteButton (/home/runner/work/LootAura/LootAura/components/FavoriteButton.tsx:13:18)
    at renderWithHooks (/home/runner/work/LootAura/LootAura/node_modules/react-dom/cjs/react-dom.development.js:15486:18)
    at mountIndeterminateComponent (/home/runner/work/LootAura/LootAura/node_modules/react-dom/cjs/react-dom.development.js:20103:13)
    at beginWork (/home/runner/work/LootAura/LootAura/node_modules/react-dom/cjs/react-dom.development.js:21626:16)
    at HTMLUnknownElement.callCallback (/home/runner/work/LootAura/LootAura/node_modules/react-dom/cjs/react-dom.development.js:4164:14)
    at HTMLUnknownElement.callTheUserObjectsOperation (/home/runner/work/LootAura/LootAura/node_modules/jsdom/lib/jsdom/living/generated/EventListener.js:26:30)
    at innerInvokeEventListeners (/home/runner/work/LootAura/LootAura/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:350:25)
    at invokeEventListeners (/home/runner/work/LootAura/LootAura/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:286:3)
    at HTMLUnknownElementImpl._dispatch (/home/runner/work/LootAura/LootAura/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:233:9)
The above error occurred in the <FavoriteButton> component:

    at FavoriteButton (/home/runner/work/LootAura/LootAura/components/FavoriteButton.tsx:11:3)
    at div
    at article
    at SaleCard (/home/runner/work/LootAura/LootAura/components/SaleCard.tsx:7:21)
    at div
    at SalesList (/home/runner/work/LootAura/LootAura/components/SalesList.tsx:7:22)
    at QueryClientProvider (file:///home/runner/work/LootAura/LootAura/node_modules/@tanstack/react-query/build/modern/QueryClientProvider.js:20:3)
    at wrapper (/home/runner/work/LootAura/LootAura/tests/utils/renderWithProviders.tsx:11:22)

Consider adding an error boundary to your tree to customize error handling behavior.
Visit https://reactjs.org/link/error-boundaries to learn more about error boundaries.
The above error occurred in the <FavoriteButton> component:

    at FavoriteButton (/home/runner/work/LootAura/LootAura/components/FavoriteButton.tsx:11:3)
    at div
    at article
    at SaleCard (/home/runner/work/LootAura/LootAura/components/SaleCard.tsx:7:21)
    at div
    at SalesList (/home/runner/work/LootAura/LootAura/components/SalesList.tsx:7:22)
    at QueryClientProvider (file:///home/runner/work/LootAura/LootAura/node_modules/@tanstack/react-query/build/modern/QueryClientProvider.js:20:3)
    at wrapper (/home/runner/work/LootAura/LootAura/tests/utils/renderWithProviders.tsx:11:22)

Consider adding an error boundary to your tree to customize error handling behavior.
Visit https://reactjs.org/link/error-boundaries to learn more about error boundaries.

stderr | tests/integration/sales-list.spec.tsx > SalesList Integration > should filter sales by category
Error: Uncaught [Error: invariant expected app router to be mounted]
    at reportException (/home/runner/work/LootAura/LootAura/node_modules/jsdom/lib/jsdom/living/helpers/runtime-script-errors.js:66:24)
    at innerInvokeEventListeners (/home/runner/work/LootAura/LootAura/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:353:9)
    at invokeEventListeners (/home/runner/work/LootAura/LootAura/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:286:3)
    at HTMLUnknownElementImpl._dispatch (/home/runner/work/LootAura/LootAura/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:233:9)
    at HTMLUnknownElementImpl.dispatchEvent (/home/runner/work/LootAura/LootAura/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:104:17)
    at HTMLUnknownElement.dispatchEvent (/home/runner/work/LootAura/LootAura/node_modules/jsdom/lib/jsdom/living/generated/EventTarget.js:241:34)
    at Object.invokeGuardedCallbackDev (/home/runner/work/LootAura/LootAura/node_modules/react-dom/cjs/react-dom.development.js:4213:16)
    at invokeGuardedCallback (/home/runner/work/LootAura/LootAura/node_modules/react-dom/cjs/react-dom.development.js:4277:31)
    at beginWork$1 (/home/runner/work/LootAura/LootAura/node_modules/react-dom/cjs/react-dom.development.js:27490:7)
    at performUnitOfWork (/home/runner/work/LootAura/LootAura/node_modules/react-dom/cjs/react-dom.development.js:26599:12) Error: invariant expected app router to be mounted
    at Proxy.useRouter (/home/runner/work/LootAura/LootAura/node_modules/next/src/client/components/navigation.ts:113:11)
    at FavoriteButton (/home/runner/work/LootAura/LootAura/components/FavoriteButton.tsx:13:18)
    at renderWithHooks (/home/runner/work/LootAura/LootAura/node_modules/react-dom/cjs/react-dom.development.js:15486:18)
    at mountIndeterminateComponent (/home/runner/work/LootAura/LootAura/node_modules/react-dom/cjs/react-dom.development.js:20103:13)
    at beginWork (/home/runner/work/LootAura/LootAura/node_modules/react-dom/cjs/react-dom.development.js:21626:16)
    at HTMLUnknownElement.callCallback (/home/runner/work/LootAura/LootAura/node_modules/react-dom/cjs/react-dom.development.js:4164:14)
    at HTMLUnknownElement.callTheUserObjectsOperation (/home/runner/work/LootAura/LootAura/node_modules/jsdom/lib/jsdom/living/generated/EventListener.js:26:30)
    at innerInvokeEventListeners (/home/runner/work/LootAura/LootAura/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:350:25)
    at invokeEventListeners (/home/runner/work/LootAura/LootAura/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:286:3)
    at HTMLUnknownElementImpl._dispatch (/home/runner/work/LootAura/LootAura/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:233:9)
Error: Uncaught [Error: invariant expected app router to be mounted]
    at reportException (/home/runner/work/LootAura/LootAura/node_modules/jsdom/lib/jsdom/living/helpers/runtime-script-errors.js:66:24)
    at innerInvokeEventListeners (/home/runner/work/LootAura/LootAura/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:353:9)
    at invokeEventListeners (/home/runner/work/LootAura/LootAura/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:286:3)
    at HTMLUnknownElementImpl._dispatch (/home/runner/work/LootAura/LootAura/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:233:9)
    at HTMLUnknownElementImpl.dispatchEvent (/home/runner/work/LootAura/LootAura/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:104:17)
    at HTMLUnknownElement.dispatchEvent (/home/runner/work/LootAura/LootAura/node_modules/jsdom/lib/jsdom/living/generated/EventTarget.js:241:34)
    at Object.invokeGuardedCallbackDev (/home/runner/work/LootAura/LootAura/node_modules/react-dom/cjs/react-dom.development.js:4213:16)
    at invokeGuardedCallback (/home/runner/work/LootAura/LootAura/node_modules/react-dom/cjs/react-dom.development.js:4277:31)
    at beginWork$1 (/home/runner/work/LootAura/LootAura/node_modules/react-dom/cjs/react-dom.development.js:27490:7)
    at performUnitOfWork (/home/runner/work/LootAura/LootAura/node_modules/react-dom/cjs/react-dom.development.js:26599:12) Error: invariant expected app router to be mounted
    at Proxy.useRouter (/home/runner/work/LootAura/LootAura/node_modules/next/src/client/components/navigation.ts:113:11)
    at FavoriteButton (/home/runner/work/LootAura/LootAura/components/FavoriteButton.tsx:13:18)
    at renderWithHooks (/home/runner/work/LootAura/LootAura/node_modules/react-dom/cjs/react-dom.development.js:15486:18)
    at mountIndeterminateComponent (/home/runner/work/LootAura/LootAura/node_modules/react-dom/cjs/react-dom.development.js:20103:13)
    at beginWork (/home/runner/work/LootAura/LootAura/node_modules/react-dom/cjs/react-dom.development.js:21626:16)
    at HTMLUnknownElement.callCallback (/home/runner/work/LootAura/LootAura/node_modules/react-dom/cjs/react-dom.development.js:4164:14)
    at HTMLUnknownElement.callTheUserObjectsOperation (/home/runner/work/LootAura/LootAura/node_modules/jsdom/lib/jsdom/living/generated/EventListener.js:26:30)
    at innerInvokeEventListeners (/home/runner/work/LootAura/LootAura/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:350:25)
    at invokeEventListeners (/home/runner/work/LootAura/LootAura/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:286:3)
    at HTMLUnknownElementImpl._dispatch (/home/runner/work/LootAura/LootAura/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:233:9)
The above error occurred in the <FavoriteButton> component:

    at FavoriteButton (/home/runner/work/LootAura/LootAura/components/FavoriteButton.tsx:11:3)
    at div
    at article
    at SaleCard (/home/runner/work/LootAura/LootAura/components/SaleCard.tsx:7:21)
    at div
    at SalesList (/home/runner/work/LootAura/LootAura/components/SalesList.tsx:7:22)
    at QueryClientProvider (file:///home/runner/work/LootAura/LootAura/node_modules/@tanstack/react-query/build/modern/QueryClientProvider.js:20:3)
    at wrapper (/home/runner/work/LootAura/LootAura/tests/utils/renderWithProviders.tsx:11:22)

Consider adding an error boundary to your tree to customize error handling behavior.
Visit https://reactjs.org/link/error-boundaries to learn more about error boundaries.

stdout | tests/integration/sales-list.spec.tsx > SalesList Integration > should filter sales by category
[DOM] list item rendered id= 1
[DOM] item mounts id= 1
[DOM] list item rendered id= 1
[DOM] item mounts id= 1

 ❯ tests/integration/sales-list.spec.tsx (3 tests | 3 failed) 85ms
   × SalesList Integration > should render sales list with proper grid layout 62ms
     → invariant expected app router to be mounted
   × SalesList Integration > should handle empty sales list 16ms
     → Invalid Chai property: toBeInTheDocument
   × SalesList Integration > should filter sales by category 7ms
     → invariant expected app router to be mounted
 ✓ tests/unit/distance.test.ts (9 tests) 5ms
stdout | tests/unit/geocode.fallback.test.ts > Geocoding Fallback > should cache results to avoid repeated API calls
[usage] geocode call (count=6)

 ✓ tests/unit/categories-parse.test.ts (7 tests) 6ms
 ✓ tests/unit/auth.ui.test.tsx (6 tests) 4ms
 ✓ tests/unit/arbiter.test.ts (5 tests) 3ms
stdout | tests/unit/geocode.fallback.test.ts > Geocoding Fallback > should handle malformed Nominatim responses
[usage] geocode call (count=7)

 ✓ tests/unit/zip-normalize.test.ts (5 tests) 4ms
 ❯ tests/components/EmptyState.test.tsx (5 tests | 5 failed) 54ms
   × EmptyState > renders with default title 37ms
     → Invalid Chai property: toBeInTheDocument
   × EmptyState > renders with custom title 4ms
     → Invalid Chai property: toBeInTheDocument
   × EmptyState > renders with custom CTA 5ms
     → Invalid Chai property: toBeInTheDocument
   × EmptyState > renders without CTA when not provided 3ms
     → Invalid Chai property: toBeInTheDocument
   × EmptyState > has correct structure 3ms
     → Invalid Chai property: toHaveClass
 ✓ tests/build-time/css-tokens.test.ts (2 tests) 3ms
 ❯ tests/unit/geocode.fallback.test.ts (8 tests | 4 failed) 7495ms
   × Geocoding Fallback > should geocode address using Nominatim 1166ms
     → expected null to deeply equal { lat: 38.1405, lng: -85.6936, …(4) }
   ✓ Geocoding Fallback > should return null when Nominatim fails 332ms
   × Geocoding Fallback > should geocode address with valid input 1828ms
     → expected null to deeply equal { lat: 38.1405, lng: -85.6936, …(4) }
   × Geocoding Fallback > should include proper headers for Nominatim requests 1603ms
     → expected null to deeply equal { lat: 38.1405, lng: -85.6936, …(4) }
   × Geocoding Fallback > should cache results to avoid repeated API calls 1134ms
     → expected null to be truthy
   ✓ Geocoding Fallback > should handle network errors gracefully 1001ms
 ✓ tests/unit/filters.test.ts (5 tests) 7ms
 ↓ tests/integration/map.render.test.tsx (1 test | 1 skipped)
 ❯ tests/components/AddSaleForm.test.tsx (0 test)
 ❯ tests/components/ReviewsSection.test.tsx (0 test)
 ❯ tests/integration/gridLayout.integration.test.tsx (0 test)

⎯⎯⎯⎯⎯⎯ Failed Suites 3 ⎯⎯⎯⎯⎯⎯⎯

 FAIL  tests/components/AddSaleForm.test.tsx [ tests/components/AddSaleForm.test.tsx ]
Error: No test suite found in file /home/runner/work/LootAura/LootAura/tests/components/AddSaleForm.test.tsx
⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/57]⎯

 FAIL  tests/components/ReviewsSection.test.tsx [ tests/components/ReviewsSection.test.tsx ]
Error: No test suite found in file /home/runner/work/LootAura/LootAura/tests/components/ReviewsSection.test.tsx
⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/57]⎯

 FAIL  tests/integration/gridLayout.integration.test.tsx [ tests/integration/gridLayout.integration.test.tsx ]
Error: No test suite found in file /home/runner/work/LootAura/LootAura/tests/integration/gridLayout.integration.test.tsx
⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[3/57]⎯

⎯⎯⎯⎯⎯⎯ Failed Tests 54 ⎯⎯⎯⎯⎯⎯⎯

 FAIL  tests/components/AddSaleForm.a11y.test.tsx > AddSaleForm Accessibility > should have proper form labels and structure
Error: Invalid Chai property: toBeInTheDocument
 ❯ tests/components/AddSaleForm.a11y.test.tsx:29:16
     27|     // Check for proper form element
     28|     const form = screen.getByRole('form')
     29|     expect(form).toBeInTheDocument()
       |                ^
     30|     
     31|     // Check for required field labels

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[4/57]⎯

 FAIL  tests/components/AddSaleForm.a11y.test.tsx > AddSaleForm Accessibility > should have proper input types and attributes
Error: Invalid Chai property: toHaveAttribute
 ❯ tests/components/AddSaleForm.a11y.test.tsx:48:22
     46|     // Check input types
     47|     const titleInput = screen.getByLabelText('Sale Title *')
     48|     expect(titleInput).toHaveAttribute('type', 'text')
       |                      ^
     49|     expect(titleInput).toHaveAttribute('required')
     50|     

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[5/57]⎯

 FAIL  tests/components/AddSaleForm.a11y.test.tsx > AddSaleForm Accessibility > should have proper button roles and labels
Error: Invalid Chai property: toBeInTheDocument
 ❯ tests/components/AddSaleForm.a11y.test.tsx:80:24
     78|     // Check submit button
     79|     const submitButton = screen.getByRole('button', { name: /post sale…
     80|     expect(submitButton).toBeInTheDocument()
       |                        ^
     81|     expect(submitButton).toHaveAttribute('type', 'submit')
     82|     

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[6/57]⎯

 FAIL  tests/components/AddSaleForm.a11y.test.tsx > AddSaleForm Accessibility > should support keyboard navigation
Error: Invalid Chai property: toHaveFocus
 ❯ tests/components/AddSaleForm.a11y.test.tsx:108:22
    106|     // Focus should move through elements in order
    107|     await user.tab()
    108|     expect(titleInput).toHaveFocus()
       |                      ^
    109|     
    110|     await user.tab()

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[7/57]⎯

 FAIL  tests/components/AddSaleForm.a11y.test.tsx > AddSaleForm Accessibility > should support form submission with Enter key
Error: Invalid Chai property: toBeInTheDocument
 ❯ tests/components/AddSaleForm.a11y.test.tsx:159:24
    157|     
    158|     // Form should be submitted (mocked)
    159|     expect(submitButton).toBeInTheDocument()
       |                        ^
    160|   })
    161| 

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[8/57]⎯

 FAIL  tests/components/AddSaleForm.a11y.test.tsx > AddSaleForm Accessibility > should support adding tags with Enter key
Error: Invalid Chai property: toBeInTheDocument
 ❯ tests/components/AddSaleForm.a11y.test.tsx:174:41
    172|     
    173|     // Tag should be added
    174|     expect(screen.getByText('furniture')).toBeInTheDocument()
       |                                         ^
    175|   })
    176| 

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[9/57]⎯

 FAIL  tests/components/AddSaleForm.a11y.test.tsx > AddSaleForm Accessibility > should have proper error handling and announcements
Error: Invalid Chai property: toBeInTheDocument
 ❯ tests/components/AddSaleForm.a11y.test.tsx:181:41
    179|     
    180|     // Initially no error should be shown
    181|     expect(screen.queryByRole('alert')).not.toBeInTheDocument()
       |                                         ^
    182|     
    183|     // Error state would be tested with actual form submission

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[10/57]⎯

 FAIL  tests/components/AddSaleForm.a11y.test.tsx > AddSaleForm Accessibility > should have proper fieldset and legend structure for grouped fields
Error: Invalid Chai property: toBeInTheDocument
 ❯ tests/components/AddSaleForm.a11y.test.tsx:194:26
    192|     const endDateLabel = screen.getByLabelText('End Date & Time')
    193|     
    194|     expect(startDateLabel).toBeInTheDocument()
       |                          ^
    195|     expect(endDateLabel).toBeInTheDocument()
    196|     

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[11/57]⎯

 FAIL  tests/components/AddSaleForm.a11y.test.tsx > AddSaleForm Accessibility > should have proper focus management
Error: Invalid Chai property: toHaveFocus
 ❯ tests/components/AddSaleForm.a11y.test.tsx:212:22
    210|     const titleInput = screen.getByLabelText('Sale Title *')
    211|     titleInput.focus()
    212|     expect(titleInput).toHaveFocus()
       |                      ^
    213|     
    214|     // Tab should move focus to next input

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[12/57]⎯

 FAIL  tests/components/AddSaleForm.a11y.test.tsx > AddSaleForm Accessibility > should have proper ARIA attributes
Error: Invalid Chai property: toBeInTheDocument
 ❯ tests/components/AddSaleForm.a11y.test.tsx:225:16
    223|     // Check for proper form role
    224|     const form = screen.getByRole('form')
    225|     expect(form).toBeInTheDocument()
       |                ^
    226|     
    227|     // Check that required fields are properly marked

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[13/57]⎯

 FAIL  tests/components/AddSaleForm.a11y.test.tsx > AddSaleForm Accessibility > should support screen reader navigation
Error: Invalid Chai property: toBeInTheDocument
 ❯ tests/components/AddSaleForm.a11y.test.tsx:244:16
    242|     // All form elements should be accessible to screen readers
    243|     const form = screen.getByRole('form')
    244|     expect(form).toBeInTheDocument()
       |                ^
    245|     
    246|     // Check that all inputs have associated labels

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[14/57]⎯

 FAIL  tests/components/EmptyState.test.tsx > EmptyState > renders with default title
Error: Invalid Chai property: toBeInTheDocument
 ❯ tests/components/EmptyState.test.tsx:9:46
      7|     render(<EmptyState />)
      8|     
      9|     expect(screen.getByText('No Sales Found')).toBeInTheDocument()
       |                                              ^
     10|     expect(screen.getByText('🔎')).toBeInTheDocument()
     11|   })

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[15/57]⎯

 FAIL  tests/components/EmptyState.test.tsx > EmptyState > renders with custom title
Error: Invalid Chai property: toBeInTheDocument
 ❯ tests/components/EmptyState.test.tsx:16:48
     14|     render(<EmptyState title="No favorites yet" />)
     15|     
     16|     expect(screen.getByText('No favorites yet')).toBeInTheDocument()
       |                                                ^
     17|     expect(screen.getByText('🔎')).toBeInTheDocument()
     18|   })

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[16/57]⎯

 FAIL  tests/components/EmptyState.test.tsx > EmptyState > renders with custom CTA
Error: Invalid Chai property: toBeInTheDocument
 ❯ tests/components/EmptyState.test.tsx:24:44
     22|     render(<EmptyState title="Custom title" cta={cta} />)
     23|     
     24|     expect(screen.getByText('Custom title')).toBeInTheDocument()
       |                                            ^
     25|     expect(screen.getByRole('button', { name: 'Click me' })).toBeInThe…
     26|   })

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[17/57]⎯

 FAIL  tests/components/EmptyState.test.tsx > EmptyState > renders without CTA when not provided
Error: Invalid Chai property: toBeInTheDocument
 ❯ tests/components/EmptyState.test.tsx:31:38
     29|     render(<EmptyState title="No CTA" />)
     30|     
     31|     expect(screen.getByText('No CTA')).toBeInTheDocument()
       |                                      ^
     32|     expect(screen.queryByRole('button')).not.toBeInTheDocument()
     33|   })

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[18/57]⎯

 FAIL  tests/components/EmptyState.test.tsx > EmptyState > has correct structure
Error: Invalid Chai property: toHaveClass
 ❯ tests/components/EmptyState.test.tsx:39:21
     37|     
     38|     const container = screen.getByText('🔎').parentElement
     39|     expect(container).toHaveClass('text-center')
       |                     ^
     40|     expect(container).toHaveClass('py-16')
     41|     expect(container).toHaveClass('text-neutral-500')

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[19/57]⎯

 FAIL  tests/components/FavoriteButton.test.tsx > FavoriteButton > renders save button when not favorited
 FAIL  tests/components/FavoriteButton.test.tsx > FavoriteButton > renders saved button when favorited
 FAIL  tests/components/FavoriteButton.test.tsx > FavoriteButton > calls toggle function when clicked
 FAIL  tests/components/FavoriteButton.test.tsx > FavoriteButton > shows loading state when pending
 FAIL  tests/components/FavoriteButton.test.tsx > FavoriteButton > has correct ARIA attributes
 FAIL  tests/integration/sales-list.spec.tsx > SalesList Integration > should render sales list with proper grid layout
 FAIL  tests/integration/sales-list.spec.tsx > SalesList Integration > should filter sales by category
Error: invariant expected app router to be mounted
 ❯ Proxy.useRouter node_modules/next/src/client/components/navigation.ts:113:11
 ❯ FavoriteButton components/FavoriteButton.tsx:13:18
     11|   initial?: boolean 
     12| }) {
     13|   const router = useRouter()
       |                  ^
     14|   const { data: user } = useAuth()
     15|   const { data: favorites = [] } = useFavorites()
 ❯ renderWithHooks node_modules/react-dom/cjs/react-dom.development.js:15486:18
 ❯ mountIndeterminateComponent node_modules/react-dom/cjs/react-dom.development.js:20103:13
 ❯ beginWork node_modules/react-dom/cjs/react-dom.development.js:21626:16
 ❯ beginWork$1 node_modules/react-dom/cjs/react-dom.development.js:27465:14
 ❯ performUnitOfWork node_modules/react-dom/cjs/react-dom.development.js:26599:12
 ❯ workLoopSync node_modules/react-dom/cjs/react-dom.development.js:26505:5
 ❯ renderRootSync node_modules/react-dom/cjs/react-dom.development.js:26473:7
 ❯ recoverFromConcurrentError node_modules/react-dom/cjs/react-dom.development.js:25889:20

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[20/57]⎯

 FAIL  tests/components/SalesGrid.test.tsx > SalesGrid > renders sales cards when not loading and sales are present
 FAIL  tests/components/SalesGrid.test.tsx > SalesGrid > renders skeletons when loading and not in MAP authority
 FAIL  tests/components/SalesGrid.test.tsx > SalesGrid > renders empty state message when no sales and not loading
 FAIL  tests/components/SalesGrid.test.tsx > SalesGrid > does not render skeletons when in MAP authority, even if loading
 FAIL  tests/components/SalesGrid.test.tsx > SalesGrid > observes resize events and updates columns
 FAIL  tests/components/SalesGrid.test.tsx > SalesGrid > cleans up ResizeObserver on unmount
 FAIL  tests/components/SalesGrid.test.tsx > SalesGrid > applies custom className
 FAIL  tests/components/SalesGrid.test.tsx > SalesGrid > sets correct data attributes
ReferenceError: ResizeObserver is not defined
 ❯ components/SalesGrid.tsx:51:28
     49|     updateColumns() // Initial calculation
     50| 
     51|     const resizeObserver = new ResizeObserver(entries => {
       |                            ^
     52|       for (const entry of entries) {
     53|         if (entry.target === gridRef.current) {
 ❯ commitHookEffectListMount node_modules/react-dom/cjs/react-dom.development.js:23189:26
 ❯ commitPassiveMountOnFiber node_modules/react-dom/cjs/react-dom.development.js:24970:11
 ❯ commitPassiveMountEffects_complete node_modules/react-dom/cjs/react-dom.development.js:24930:9
 ❯ commitPassiveMountEffects_begin node_modules/react-dom/cjs/react-dom.development.js:24917:7
 ❯ commitPassiveMountEffects node_modules/react-dom/cjs/react-dom.development.js:24905:3
 ❯ flushPassiveEffectsImpl node_modules/react-dom/cjs/react-dom.development.js:27078:3
 ❯ flushPassiveEffects node_modules/react-dom/cjs/react-dom.development.js:27023:14
 ❯ node_modules/react-dom/cjs/react-dom.development.js:26808:9
 ❯ flushActQueue node_modules/react/cjs/react.development.js:2667:24

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[21/57]⎯

 FAIL  tests/integration/addSale.insert.test.tsx > Add Sale Integration > should insert sale with geocoded coordinates
Error: Invalid Chai property: toBeInTheDocument
 ❯ tests/integration/addSale.insert.test.tsx:108:46
    106| 
    107|     // Verify the form is rendered
    108|     expect(screen.getByText('Post Your Sale')).toBeInTheDocument()
       |                                              ^
    109|     expect(screen.getByLabelText('Sale Title *')).toBeInTheDocument()
    110|     expect(screen.getByLabelText('Address *')).toBeInTheDocument()

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[22/57]⎯

 FAIL  tests/integration/addSale.insert.test.tsx > Add Sale Integration > should handle geocoding failure gracefully
Error: Invalid Chai property: toBeInTheDocument
 ❯ tests/integration/addSale.insert.test.tsx:121:24
    119|     // Try to submit without required fields
    120|     const submitButton = screen.getByRole('button', { name: /^post sal…
    121|     expect(submitButton).toBeInTheDocument()
       |                        ^
    122|   })
    123| 

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[23/57]⎯

 FAIL  tests/integration/addSale.insert.test.tsx > Add Sale Integration > should validate required fields before submission
Error: Invalid Chai property: toBeInTheDocument
 ❯ tests/integration/addSale.insert.test.tsx:131:24
    129|     // Try to submit without required fields
    130|     const submitButton = screen.getByRole('button', { name: /^post sal…
    131|     expect(submitButton).toBeInTheDocument()
       |                        ^
    132|   })
    133| 

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[24/57]⎯

 FAIL  tests/integration/addSale.insert.test.tsx > Add Sale Integration > should show loading state during submission
Error: Invalid Chai property: toBeInTheDocument
 ❯ tests/integration/addSale.insert.test.tsx:140:48
    138| 
    139|     // Check for loading state
    140|     expect(screen.getAllByText('Posting...')[0]).toBeInTheDocument()
       |                                                ^
    141|   })
    142| 

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[25/57]⎯

 FAIL  tests/integration/addSale.insert.test.tsx > Add Sale Integration > should handle submission errors
Error: Invalid Chai property: toBeInTheDocument
 ❯ tests/integration/addSale.insert.test.tsx:149:64
    147| 
    148|     // Check for error handling
    149|     expect(screen.getByRole('button', { name: /^post sale$/i })).toBeI…
       |                                                                ^
    150|   })
    151| 

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[26/57]⎯

 FAIL  tests/integration/addSale.insert.test.tsx > Add Sale Integration > should include owner_id in inserted data
Error: Invalid Chai property: toBeInTheDocument
 ❯ tests/integration/addSale.insert.test.tsx:158:64
    156| 
    157|     // Check that the form includes owner_id
    158|     expect(screen.getByRole('button', { name: /^post sale$/i })).toBeI…
       |                                                                ^
    159|   })
    160| 

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[27/57]⎯

 FAIL  tests/integration/addSale.insert.test.tsx > Add Sale Integration > should update React Query cache after successful creation
Error: Invalid Chai property: toBeInTheDocument
 ❯ tests/integration/addSale.insert.test.tsx:167:46
    165| 
    166|     // Check that the form is rendered
    167|     expect(screen.getByText('Post Your Sale')).toBeInTheDocument()
       |                                              ^
    168|     expect(screen.getByLabelText('Sale Title *')).toBeInTheDocument()
    169|   })

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[28/57]⎯

 FAIL  tests/integration/rls.owner.test.ts > RLS and Owner Permissions > should set owner_id to auth.uid() when inserting sale
TypeError: vi.mocked(...).mockResolvedValue is not a function
 ❯ tests/integration/rls.owner.test.ts:22:38
     20| 
     21|     // Mock authenticated user
     22|     vi.mocked(supabase.auth.getUser).mockResolvedValue({
       |                                      ^
     23|       data: { user: { id: testUserId, email: 'test@example.com' } },
     24|       error: null

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[29/57]⎯

 FAIL  tests/integration/rls.owner.test.ts > RLS and Owner Permissions > should allow public read access to sales list
TypeError: vi.mocked(...).mockResolvedValue is not a function
 ❯ tests/integration/rls.owner.test.ts:52:38
     50| 
     51|     // Mock anonymous user
     52|     vi.mocked(supabase.auth.getUser).mockResolvedValue({
       |                                      ^
     53|       data: { user: null },
     54|       error: null

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[30/57]⎯

 FAIL  tests/integration/rls.owner.test.ts > RLS and Owner Permissions > should allow owner to update their own sale
TypeError: vi.mocked(...).mockResolvedValue is not a function
 ❯ tests/integration/rls.owner.test.ts:83:38
     81| 
     82|     // Mock authenticated user
     83|     vi.mocked(supabase.auth.getUser).mockResolvedValue({
       |                                      ^
     84|       data: { user: { id: testUserId, email: 'test@example.com' } },
     85|       error: null

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[31/57]⎯

 FAIL  tests/integration/rls.owner.test.ts > RLS and Owner Permissions > should prevent non-owner from updating sale
TypeError: vi.mocked(...).mockResolvedValue is not a function
 ❯ tests/integration/rls.owner.test.ts:120:38
    118| 
    119|     // Mock authenticated user
    120|     vi.mocked(supabase.auth.getUser).mockResolvedValue({
       |                                      ^
    121|       data: { user: { id: testUserId, email: 'test@example.com' } },
    122|       error: null

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[32/57]⎯

 FAIL  tests/integration/rls.owner.test.ts > RLS and Owner Permissions > should allow owner to delete their own sale
TypeError: vi.mocked(...).mockResolvedValue is not a function
 ❯ tests/integration/rls.owner.test.ts:157:38
    155| 
    156|     // Mock authenticated user
    157|     vi.mocked(supabase.auth.getUser).mockResolvedValue({
       |                                      ^
    158|       data: { user: { id: testUserId, email: 'test@example.com' } },
    159|       error: null

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[33/57]⎯

 FAIL  tests/integration/rls.owner.test.ts > RLS and Owner Permissions > should prevent non-owner from deleting sale
TypeError: supabase.auth.getUser.mockResolvedValue is not a function
 ❯ tests/integration/rls.owner.test.ts:193:27
    191| 
    192|     // Mock authenticated user
    193|     supabase.auth.getUser.mockResolvedValue({
       |                           ^
    194|       data: { user: { id: testUserId, email: 'test@example.com' } }
    195|     })

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[34/57]⎯

 FAIL  tests/integration/sales-list.spec.tsx > SalesList Integration > should handle empty sales list
Error: Invalid Chai property: toBeInTheDocument
 ❯ tests/integration/sales-list.spec.tsx:72:47
     70| 
     71|     // Should show empty state
     72|     expect(screen.getByText(/no sales found/i)).toBeInTheDocument()
       |                                               ^
     73|   })
     74| 

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[35/57]⎯

 FAIL  tests/stability/list.dom.spec.tsx > list.dom > should render list panel with correct data attribute
Error: Invalid Chai property: toHaveAttribute
 ❯ tests/stability/list.dom.spec.tsx:52:21
     50|     const listPanel = container.querySelector('[data-panel="list"]')
     51|     expect(listPanel).toBeTruthy()
     52|     expect(listPanel).toHaveAttribute('data-panel', 'list')
       |                     ^
     53|   })
     54|   

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[36/57]⎯

 FAIL  tests/stability/list.dom.spec.tsx > list.dom > should render sale cards as descendants of list panel
Error: Invalid Chai property: toHaveAttribute
 ❯ tests/stability/list.dom.spec.tsx:68:18
     66|     // Verify each card has the correct attributes
     67|     saleCards?.forEach((card, index) => {
     68|       expect(card).toHaveAttribute('data-card', 'sale')
       |                  ^
     69|       expect(card).toHaveAttribute('data-sale-id', sales[index])
     70|     })
 ❯ tests/stability/list.dom.spec.tsx:67:16

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[37/57]⎯

 Test Files  13 failed | 33 passed | 2 skipped (48)
 FAIL  tests/stability/list.dom.spec.tsx > list.dom > should have grid wrapper classes on list panel
      Tests  54 failed | 385 passed | 3 skipped | 1 todo (443)
Error: Invalid Chai property: toHaveClass
   Start at  05:00:00
 ❯ tests/stability/list.dom.spec.tsx:81:21
   Duration  17.30s (transform 881ms, setup 149ms, collect 3.20s, tests 9.32s, environment 26.25s, prepare 3.73s)
     79|     

     80|     // Confirm grid wrapper class presence
     81|     expect(listPanel).toHaveClass('w-full')
       |                     ^
     82|     expect(listPanel).toHaveClass('grid')
     83|     expect(listPanel).toHaveClass('grid-cols-1')

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[38/57]⎯

 FAIL  tests/stability/list.dom.spec.tsx > list.dom > should maintain grid structure with single card
Error: Invalid Chai property: toHaveClass
 ❯ tests/stability/list.dom.spec.tsx:122:21
    120|     
    121|     // Verify grid classes are still present
    122|     expect(listPanel).toHaveClass('grid')
       |                     ^
    123|     expect(listPanel).toHaveClass('grid-cols-1')
    124|     

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[39/57]⎯

 FAIL  tests/unit/env.test.ts > Environment Validation > should handle missing optional variables
AssertionError: expected undefined to be 'https://lootaura.app' // Object.is equality

- Expected: 
"https://lootaura.app"

+ Received: 
undefined

 ❯ tests/unit/env.test.ts:87:45
     85| 
     86|     // Accept the default value from global mock
     87|     expect(ENV_PUBLIC.NEXT_PUBLIC_SITE_URL).toBe('https://lootaura.app…
       |                                             ^
     88|     expect(ENV_PUBLIC.NEXT_PUBLIC_VAPID_PUBLIC_KEY).toBeUndefined()
     89|   })

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[40/57]⎯

 FAIL  tests/unit/geocode.fallback.test.ts > Geocoding Fallback > should geocode address using Nominatim
AssertionError: expected null to deeply equal { lat: 38.1405, lng: -85.6936, …(4) }

- Expected: 
Object {
  "city": "Louisville",
  "formatted_address": "123 Test St, Louisville, KY",
  "lat": 38.1405,
  "lng": -85.6936,
  "state": "KY",
  "zip": "40201",
}

+ Received: 
null

 ❯ tests/unit/geocode.fallback.test.ts:31:20
     29|     
     30|     // Should get Louisville coordinates from Nominatim
     31|     expect(result).toEqual({
       |                    ^
     32|       lat: 38.1405,
     33|       lng: -85.6936,

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[41/57]⎯

 FAIL  tests/unit/geocode.fallback.test.ts > Geocoding Fallback > should geocode address with valid input
AssertionError: expected null to deeply equal { lat: 38.1405, lng: -85.6936, …(4) }

- Expected: 
Object {
  "city": "Louisville",
  "formatted_address": "123 Test St, Louisville, KY",
  "lat": 38.1405,
  "lng": -85.6936,
  "state": "KY",
  "zip": "40201",
}

+ Received: 
null

 ❯ tests/unit/geocode.fallback.test.ts:54:20
     52|     const result = await geocodeAddress(testAddress.address)
     53|     
     54|     expect(result).toEqual({
       |                    ^
     55|       lat: 38.1405,
     56|       lng: -85.6936,

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[42/57]⎯

 FAIL  tests/unit/geocode.fallback.test.ts > Geocoding Fallback > should include proper headers for Nominatim requests
AssertionError: expected null to deeply equal { lat: 38.1405, lng: -85.6936, …(4) }

- Expected: 
Object {
  "city": "Louisville",
  "formatted_address": "123 Test St, Louisville, KY",
  "lat": 38.1405,
  "lng": -85.6936,
  "state": "KY",
  "zip": "40201",
}

+ Received: 
null

 ❯ tests/unit/geocode.fallback.test.ts:84:20
     82|     
     83|     // Should get Louisville coordinates from Nominatim
     84|     expect(result).toEqual({
       |                    ^
     85|       lat: 38.1405,
     86|       lng: -85.6936,

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[43/57]⎯

 FAIL  tests/unit/geocode.fallback.test.ts > Geocoding Fallback > should cache results to avoid repeated API calls
AssertionError: expected null to be truthy

- Expected: 
true

+ Received: 
null

 ❯ tests/unit/geocode.fallback.test.ts:103:21
    101|     // First call
    102|     const result1 = await geocodeAddress(testAddress.address)
    103|     expect(result1).toBeTruthy()
       |                     ^
    104|     
    105|     // Second call should use cache

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[44/57]⎯


Error: Error: Invalid Chai property: toBeInTheDocument
 ❯ tests/components/AddSaleForm.a11y.test.tsx:29:16



Error: Error: Invalid Chai property: toHaveAttribute
 ❯ tests/components/AddSaleForm.a11y.test.tsx:48:22



Error: Error: Invalid Chai property: toBeInTheDocument
 ❯ tests/components/AddSaleForm.a11y.test.tsx:80:24



Error: Error: Invalid Chai property: toHaveFocus
 ❯ tests/components/AddSaleForm.a11y.test.tsx:108:22



Error: Error: Invalid Chai property: toBeInTheDocument
 ❯ tests/components/AddSaleForm.a11y.test.tsx:159:24



Error: Error: Invalid Chai property: toBeInTheDocument
 ❯ tests/components/AddSaleForm.a11y.test.tsx:174:41



Error: Error: Invalid Chai property: toBeInTheDocument
 ❯ tests/components/AddSaleForm.a11y.test.tsx:181:41



Error: Error: Invalid Chai property: toBeInTheDocument
 ❯ tests/components/AddSaleForm.a11y.test.tsx:194:26



Error: Error: Invalid Chai property: toHaveFocus
 ❯ tests/components/AddSaleForm.a11y.test.tsx:212:22



Error: Error: Invalid Chai property: toBeInTheDocument
 ❯ tests/components/AddSaleForm.a11y.test.tsx:225:16



Error: Error: Invalid Chai property: toBeInTheDocument
 ❯ tests/components/AddSaleForm.a11y.test.tsx:244:16



Error: Error: Invalid Chai property: toBeInTheDocument
 ❯ tests/components/EmptyState.test.tsx:9:46



Error: Error: Invalid Chai property: toBeInTheDocument
 ❯ tests/components/EmptyState.test.tsx:16:48



Error: Error: Invalid Chai property: toBeInTheDocument
 ❯ tests/components/EmptyState.test.tsx:24:44



Error: Error: Invalid Chai property: toBeInTheDocument
 ❯ tests/components/EmptyState.test.tsx:31:38



Error: Error: Invalid Chai property: toHaveClass
 ❯ tests/components/EmptyState.test.tsx:39:21



Error: Error: invariant expected app router to be mounted
 ❯ Proxy.useRouter node_modules/next/src/client/components/navigation.ts:113:11
 ❯ FavoriteButton components/FavoriteButton.tsx:13:18
 ❯ renderWithHooks node_modules/react-dom/cjs/react-dom.development.js:15486:18
 ❯ mountIndeterminateComponent node_modules/react-dom/cjs/react-dom.development.js:20103:13
 ❯ beginWork node_modules/react-dom/cjs/react-dom.development.js:21626:16
 ❯ beginWork$1 node_modules/react-dom/cjs/react-dom.development.js:27465:14
 ❯ performUnitOfWork node_modules/react-dom/cjs/react-dom.development.js:26599:12
 ❯ workLoopSync node_modules/react-dom/cjs/react-dom.development.js:26505:5
 ❯ renderRootSync node_modules/react-dom/cjs/react-dom.development.js:26473:7
 ❯ recoverFromConcurrentError node_modules/react-dom/cjs/react-dom.development.js:25889:20



Error: Error: invariant expected app router to be mounted
 ❯ Proxy.useRouter node_modules/next/src/client/components/navigation.ts:113:11
 ❯ FavoriteButton components/FavoriteButton.tsx:13:18
 ❯ renderWithHooks node_modules/react-dom/cjs/react-dom.development.js:15486:18
 ❯ mountIndeterminateComponent node_modules/react-dom/cjs/react-dom.development.js:20103:13
 ❯ beginWork node_modules/react-dom/cjs/react-dom.development.js:21626:16
 ❯ beginWork$1 node_modules/react-dom/cjs/react-dom.development.js:27465:14
 ❯ performUnitOfWork node_modules/react-dom/cjs/react-dom.development.js:26599:12
 ❯ workLoopSync node_modules/react-dom/cjs/react-dom.development.js:26505:5
 ❯ renderRootSync node_modules/react-dom/cjs/react-dom.development.js:26473:7
 ❯ recoverFromConcurrentError node_modules/react-dom/cjs/react-dom.development.js:25889:20



Error: Error: invariant expected app router to be mounted
 ❯ Proxy.useRouter node_modules/next/src/client/components/navigation.ts:113:11
 ❯ FavoriteButton components/FavoriteButton.tsx:13:18
 ❯ renderWithHooks node_modules/react-dom/cjs/react-dom.development.js:15486:18
 ❯ mountIndeterminateComponent node_modules/react-dom/cjs/react-dom.development.js:20103:13
 ❯ beginWork node_modules/react-dom/cjs/react-dom.development.js:21626:16
 ❯ beginWork$1 node_modules/react-dom/cjs/react-dom.development.js:27465:14
 ❯ performUnitOfWork node_modules/react-dom/cjs/react-dom.development.js:26599:12
 ❯ workLoopSync node_modules/react-dom/cjs/react-dom.development.js:26505:5
 ❯ renderRootSync node_modules/react-dom/cjs/react-dom.development.js:26473:7
 ❯ recoverFromConcurrentError node_modules/react-dom/cjs/react-dom.development.js:25889:20



Error: Error: invariant expected app router to be mounted
 ❯ Proxy.useRouter node_modules/next/src/client/components/navigation.ts:113:11
 ❯ FavoriteButton components/FavoriteButton.tsx:13:18
 ❯ renderWithHooks node_modules/react-dom/cjs/react-dom.development.js:15486:18
 ❯ mountIndeterminateComponent node_modules/react-dom/cjs/react-dom.development.js:20103:13
 ❯ beginWork node_modules/react-dom/cjs/react-dom.development.js:21626:16
 ❯ beginWork$1 node_modules/react-dom/cjs/react-dom.development.js:27465:14
 ❯ performUnitOfWork node_modules/react-dom/cjs/react-dom.development.js:26599:12
 ❯ workLoopSync node_modules/react-dom/cjs/react-dom.development.js:26505:5
 ❯ renderRootSync node_modules/react-dom/cjs/react-dom.development.js:26473:7
 ❯ recoverFromConcurrentError node_modules/react-dom/cjs/react-dom.development.js:25889:20



Error: Error: invariant expected app router to be mounted
 ❯ Proxy.useRouter node_modules/next/src/client/components/navigation.ts:113:11
 ❯ FavoriteButton components/FavoriteButton.tsx:13:18
 ❯ renderWithHooks node_modules/react-dom/cjs/react-dom.development.js:15486:18
 ❯ mountIndeterminateComponent node_modules/react-dom/cjs/react-dom.development.js:20103:13
 ❯ beginWork node_modules/react-dom/cjs/react-dom.development.js:21626:16
 ❯ beginWork$1 node_modules/react-dom/cjs/react-dom.development.js:27465:14
 ❯ performUnitOfWork node_modules/react-dom/cjs/react-dom.development.js:26599:12
 ❯ workLoopSync node_modules/react-dom/cjs/react-dom.development.js:26505:5
 ❯ renderRootSync node_modules/react-dom/cjs/react-dom.development.js:26473:7
 ❯ recoverFromConcurrentError node_modules/react-dom/cjs/react-dom.development.js:25889:20



Error: ReferenceError: ResizeObserver is not defined
 ❯ components/SalesGrid.tsx:51:28
 ❯ commitHookEffectListMount node_modules/react-dom/cjs/react-dom.development.js:23189:26
 ❯ commitPassiveMountOnFiber node_modules/react-dom/cjs/react-dom.development.js:24970:11
 ❯ commitPassiveMountEffects_complete node_modules/react-dom/cjs/react-dom.development.js:24930:9
 ❯ commitPassiveMountEffects_begin node_modules/react-dom/cjs/react-dom.development.js:24917:7
 ❯ commitPassiveMountEffects node_modules/react-dom/cjs/react-dom.development.js:24905:3
 ❯ flushPassiveEffectsImpl node_modules/react-dom/cjs/react-dom.development.js:27078:3
 ❯ flushPassiveEffects node_modules/react-dom/cjs/react-dom.development.js:27023:14
 ❯ node_modules/react-dom/cjs/react-dom.development.js:26808:9
 ❯ flushActQueue node_modules/react/cjs/react.development.js:2667:24



Error: ReferenceError: ResizeObserver is not defined
 ❯ components/SalesGrid.tsx:51:28
 ❯ commitHookEffectListMount node_modules/react-dom/cjs/react-dom.development.js:23189:26
 ❯ commitPassiveMountOnFiber node_modules/react-dom/cjs/react-dom.development.js:24970:11
 ❯ commitPassiveMountEffects_complete node_modules/react-dom/cjs/react-dom.development.js:24930:9
 ❯ commitPassiveMountEffects_begin node_modules/react-dom/cjs/react-dom.development.js:24917:7
 ❯ commitPassiveMountEffects node_modules/react-dom/cjs/react-dom.development.js:24905:3
 ❯ flushPassiveEffectsImpl node_modules/react-dom/cjs/react-dom.development.js:27078:3
 ❯ flushPassiveEffects node_modules/react-dom/cjs/react-dom.development.js:27023:14
 ❯ node_modules/react-dom/cjs/react-dom.development.js:26808:9
 ❯ flushActQueue node_modules/react/cjs/react.development.js:2667:24



Error: ReferenceError: ResizeObserver is not defined
 ❯ components/SalesGrid.tsx:51:28
 ❯ commitHookEffectListMount node_modules/react-dom/cjs/react-dom.development.js:23189:26
 ❯ commitPassiveMountOnFiber node_modules/react-dom/cjs/react-dom.development.js:24970:11
 ❯ commitPassiveMountEffects_complete node_modules/react-dom/cjs/react-dom.development.js:24930:9
 ❯ commitPassiveMountEffects_begin node_modules/react-dom/cjs/react-dom.development.js:24917:7
 ❯ commitPassiveMountEffects node_modules/react-dom/cjs/react-dom.development.js:24905:3
 ❯ flushPassiveEffectsImpl node_modules/react-dom/cjs/react-dom.development.js:27078:3
 ❯ flushPassiveEffects node_modules/react-dom/cjs/react-dom.development.js:27023:14
 ❯ node_modules/react-dom/cjs/react-dom.development.js:26808:9
 ❯ flushActQueue node_modules/react/cjs/react.development.js:2667:24



Error: ReferenceError: ResizeObserver is not defined
 ❯ components/SalesGrid.tsx:51:28
 ❯ commitHookEffectListMount node_modules/react-dom/cjs/react-dom.development.js:23189:26
 ❯ commitPassiveMountOnFiber node_modules/react-dom/cjs/react-dom.development.js:24970:11
 ❯ commitPassiveMountEffects_complete node_modules/react-dom/cjs/react-dom.development.js:24930:9
 ❯ commitPassiveMountEffects_begin node_modules/react-dom/cjs/react-dom.development.js:24917:7
 ❯ commitPassiveMountEffects node_modules/react-dom/cjs/react-dom.development.js:24905:3
 ❯ flushPassiveEffectsImpl node_modules/react-dom/cjs/react-dom.development.js:27078:3
 ❯ flushPassiveEffects node_modules/react-dom/cjs/react-dom.development.js:27023:14
 ❯ node_modules/react-dom/cjs/react-dom.development.js:26808:9
 ❯ flushActQueue node_modules/react/cjs/react.development.js:2667:24



Error: ReferenceError: ResizeObserver is not defined
 ❯ components/SalesGrid.tsx:51:28
 ❯ commitHookEffectListMount node_modules/react-dom/cjs/react-dom.development.js:23189:26
 ❯ commitPassiveMountOnFiber node_modules/react-dom/cjs/react-dom.development.js:24970:11
 ❯ commitPassiveMountEffects_complete node_modules/react-dom/cjs/react-dom.development.js:24930:9
 ❯ commitPassiveMountEffects_begin node_modules/react-dom/cjs/react-dom.development.js:24917:7
 ❯ commitPassiveMountEffects node_modules/react-dom/cjs/react-dom.development.js:24905:3
 ❯ flushPassiveEffectsImpl node_modules/react-dom/cjs/react-dom.development.js:27078:3
 ❯ flushPassiveEffects node_modules/react-dom/cjs/react-dom.development.js:27023:14
 ❯ node_modules/react-dom/cjs/react-dom.development.js:26808:9
 ❯ flushActQueue node_modules/react/cjs/react.development.js:2667:24



Error: ReferenceError: ResizeObserver is not defined
 ❯ components/SalesGrid.tsx:51:28
 ❯ commitHookEffectListMount node_modules/react-dom/cjs/react-dom.development.js:23189:26
 ❯ commitPassiveMountOnFiber node_modules/react-dom/cjs/react-dom.development.js:24970:11
 ❯ commitPassiveMountEffects_complete node_modules/react-dom/cjs/react-dom.development.js:24930:9
 ❯ commitPassiveMountEffects_begin node_modules/react-dom/cjs/react-dom.development.js:24917:7
 ❯ commitPassiveMountEffects node_modules/react-dom/cjs/react-dom.development.js:24905:3
 ❯ flushPassiveEffectsImpl node_modules/react-dom/cjs/react-dom.development.js:27078:3
 ❯ flushPassiveEffects node_modules/react-dom/cjs/react-dom.development.js:27023:14
 ❯ node_modules/react-dom/cjs/react-dom.development.js:26808:9
 ❯ flushActQueue node_modules/react/cjs/react.development.js:2667:24



Error: ReferenceError: ResizeObserver is not defined
 ❯ components/SalesGrid.tsx:51:28
 ❯ commitHookEffectListMount node_modules/react-dom/cjs/react-dom.development.js:23189:26
 ❯ commitPassiveMountOnFiber node_modules/react-dom/cjs/react-dom.development.js:24970:11
 ❯ commitPassiveMountEffects_complete node_modules/react-dom/cjs/react-dom.development.js:24930:9
 ❯ commitPassiveMountEffects_begin node_modules/react-dom/cjs/react-dom.development.js:24917:7
 ❯ commitPassiveMountEffects node_modules/react-dom/cjs/react-dom.development.js:24905:3
 ❯ flushPassiveEffectsImpl node_modules/react-dom/cjs/react-dom.development.js:27078:3
 ❯ flushPassiveEffects node_modules/react-dom/cjs/react-dom.development.js:27023:14
 ❯ node_modules/react-dom/cjs/react-dom.development.js:26808:9
 ❯ flushActQueue node_modules/react/cjs/react.development.js:2667:24



Error: ReferenceError: ResizeObserver is not defined
 ❯ components/SalesGrid.tsx:51:28
 ❯ commitHookEffectListMount node_modules/react-dom/cjs/react-dom.development.js:23189:26
 ❯ commitPassiveMountOnFiber node_modules/react-dom/cjs/react-dom.development.js:24970:11
 ❯ commitPassiveMountEffects_complete node_modules/react-dom/cjs/react-dom.development.js:24930:9
 ❯ commitPassiveMountEffects_begin node_modules/react-dom/cjs/react-dom.development.js:24917:7
 ❯ commitPassiveMountEffects node_modules/react-dom/cjs/react-dom.development.js:24905:3
 ❯ flushPassiveEffectsImpl node_modules/react-dom/cjs/react-dom.development.js:27078:3
 ❯ flushPassiveEffects node_modules/react-dom/cjs/react-dom.development.js:27023:14
 ❯ node_modules/react-dom/cjs/react-dom.development.js:26808:9
 ❯ flushActQueue node_modules/react/cjs/react.development.js:2667:24



Error: Error: Invalid Chai property: toBeInTheDocument
 ❯ tests/integration/addSale.insert.test.tsx:108:46



Error: Error: Invalid Chai property: toBeInTheDocument
 ❯ tests/integration/addSale.insert.test.tsx:121:24



Error: Error: Invalid Chai property: toBeInTheDocument
 ❯ tests/integration/addSale.insert.test.tsx:131:24



Error: Error: Invalid Chai property: toBeInTheDocument
 ❯ tests/integration/addSale.insert.test.tsx:140:48



Error: Error: Invalid Chai property: toBeInTheDocument
 ❯ tests/integration/addSale.insert.test.tsx:149:64



Error: Error: Invalid Chai property: toBeInTheDocument
 ❯ tests/integration/addSale.insert.test.tsx:158:64



Error: Error: Invalid Chai property: toBeInTheDocument
 ❯ tests/integration/addSale.insert.test.tsx:167:46



Error: TypeError: vi.mocked(...).mockResolvedValue is not a function
 ❯ tests/integration/rls.owner.test.ts:22:38



Error: TypeError: vi.mocked(...).mockResolvedValue is not a function
 ❯ tests/integration/rls.owner.test.ts:52:38



Error: TypeError: vi.mocked(...).mockResolvedValue is not a function
 ❯ tests/integration/rls.owner.test.ts:83:38



Error: TypeError: vi.mocked(...).mockResolvedValue is not a function
 ❯ tests/integration/rls.owner.test.ts:120:38



Error: TypeError: vi.mocked(...).mockResolvedValue is not a function
 ❯ tests/integration/rls.owner.test.ts:157:38



Error: TypeError: supabase.auth.getUser.mockResolvedValue is not a function
 ❯ tests/integration/rls.owner.test.ts:193:27



Error: Error: invariant expected app router to be mounted
 ❯ Proxy.useRouter node_modules/next/src/client/components/navigation.ts:113:11
 ❯ FavoriteButton components/FavoriteButton.tsx:13:18
 ❯ renderWithHooks node_modules/react-dom/cjs/react-dom.development.js:15486:18
 ❯ mountIndeterminateComponent node_modules/react-dom/cjs/react-dom.development.js:20103:13
 ❯ beginWork node_modules/react-dom/cjs/react-dom.development.js:21626:16
 ❯ beginWork$1 node_modules/react-dom/cjs/react-dom.development.js:27465:14
 ❯ performUnitOfWork node_modules/react-dom/cjs/react-dom.development.js:26599:12
 ❯ workLoopSync node_modules/react-dom/cjs/react-dom.development.js:26505:5
 ❯ renderRootSync node_modules/react-dom/cjs/react-dom.development.js:26473:7
 ❯ recoverFromConcurrentError node_modules/react-dom/cjs/react-dom.development.js:25889:20



Error: Error: Invalid Chai property: toBeInTheDocument
 ❯ tests/integration/sales-list.spec.tsx:72:47



Error: Error: invariant expected app router to be mounted
 ❯ Proxy.useRouter node_modules/next/src/client/components/navigation.ts:113:11
 ❯ FavoriteButton components/FavoriteButton.tsx:13:18
 ❯ renderWithHooks node_modules/react-dom/cjs/react-dom.development.js:15486:18
 ❯ mountIndeterminateComponent node_modules/react-dom/cjs/react-dom.development.js:20103:13
 ❯ beginWork node_modules/react-dom/cjs/react-dom.development.js:21626:16
 ❯ beginWork$1 node_modules/react-dom/cjs/react-dom.development.js:27465:14
 ❯ performUnitOfWork node_modules/react-dom/cjs/react-dom.development.js:26599:12
 ❯ workLoopSync node_modules/react-dom/cjs/react-dom.development.js:26505:5
 ❯ renderRootSync node_modules/react-dom/cjs/react-dom.development.js:26473:7
 ❯ recoverFromConcurrentError node_modules/react-dom/cjs/react-dom.development.js:25889:20



Error: Error: Invalid Chai property: toHaveAttribute
 ❯ tests/stability/list.dom.spec.tsx:52:21



Error: Error: Invalid Chai property: toHaveAttribute
 ❯ tests/stability/list.dom.spec.tsx:68:18
 ❯ tests/stability/list.dom.spec.tsx:67:16



Error: Error: Invalid Chai property: toHaveClass
 ❯ tests/stability/list.dom.spec.tsx:81:21



Error: Error: Invalid Chai property: toHaveClass
 ❯ tests/stability/list.dom.spec.tsx:122:21



Error: AssertionError: expected undefined to be 'https://lootaura.app' // Object.is equality

- Expected: 
"https://lootaura.app"

+ Received: 
undefined

 ❯ tests/unit/env.test.ts:87:45



Error: AssertionError: expected null to deeply equal { lat: 38.1405, lng: -85.6936, …(4) }

- Expected: 
Object {
  "city": "Louisville",
  "formatted_address": "123 Test St, Louisville, KY",
  "lat": 38.1405,
  "lng": -85.6936,
  "state": "KY",
  "zip": "40201",
}

+ Received: 
null

 ❯ tests/unit/geocode.fallback.test.ts:31:20



Error: AssertionError: expected null to deeply equal { lat: 38.1405, lng: -85.6936, …(4) }

- Expected: 
Object {
  "city": "Louisville",
  "formatted_address": "123 Test St, Louisville, KY",
  "lat": 38.1405,
  "lng": -85.6936,
  "state": "KY",
  "zip": "40201",
}

+ Received: 
null

 ❯ tests/unit/geocode.fallback.test.ts:54:20



Error: AssertionError: expected null to deeply equal { lat: 38.1405, lng: -85.6936, …(4) }

- Expected: 
Object {
  "city": "Louisville",
  "formatted_address": "123 Test St, Louisville, KY",
  "lat": 38.1405,
  "lng": -85.6936,
  "state": "KY",
  "zip": "40201",
}

+ Received: 
null

 ❯ tests/unit/geocode.fallback.test.ts:84:20



Error: AssertionError: expected null to be truthy

- Expected: 
true

+ Received: 
null

 ❯ tests/unit/geocode.fallback.test.ts:103:21


(node:2180) MaxListenersExceededWarning: Possible EventEmitter memory leak detected. 11 unhandledRejection listeners added to [process]. MaxListeners is 10. Use emitter.setMaxListeners() to increase limit
(Use `node --trace-warnings ...` to show where the warning was created)
Error: Process completed with exit code 1.